{% extends 'xadmin/base_site.html' %}

{% block content-nav %}
{% endblock %}

{% block content %} 
    {% if blockDetail %}
    <div style="width:100%; height:65px; border-radius: 4px; border: solid 2px #d9534f; margin-left: 3px; background-color: rgb(249, 225, 225);">
        <div style="margin-left:2%; margin-top:10px;">
            <div class="row">
                <div class="col-md-1" style="width:4.33%">
                    <span class="glyphicon glyphicon-exclamation-sign" style="font-size: 3em;"></span>
                </div>
                <div class="col-md-10" style="margin-top:1px;">
                    <span style="line-height: 10px;">This member's account has been closed on {{ blockDetail.date }} by {{ blockDetail.admin }}. Actions on the account are disabled unless the account is re-opened. Only a system adminstrator can re-open the account.</span>
                </div>
                <div class="col-md-1" style="margin-top:3px;">
                    <div>
                        <button type="button" id="open-account-btn" class="btn btn-primary" style="margin-left: -8%;" onclick="userBlockAction('open')">
                            Re-open account
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- fund status section -->
    <div class="row" id="fund-rectangle">
        <div class="detail-title-block" style="background-color: #00a281;">
            <span class="detail-title">Fund status</span>
        </div>
        <div class="row" style="margin-top:20px; min-height: 165px;">
            <div class="col-md-6" >
                    <div class="col-md-3" style="padding-right:2%">
                        <div class="block-title"><span></span></div>
                        <div class="block-title"><span>TOTAL BALANCE</span></div>
                        <div class="fund-block">
                            <div class="status-block-content">
                                ${{ totalBalance|floatformat:2  }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3" style="padding-right:2%">
                        <div class="block-title"><span>MAIN</span></div>
                        <div class="block-title"><span>WALLET BALANCE</span></div>
                        <div class="fund-block">
                            <div class="status-block-content">
                                ${{ customuser.main_wallet|floatformat:2  }}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3" style="padding-right:2%">
                        <div class="block-title"><span>AVAILAVLE FOR</span></div>
                        <div class="block-title"><span>WITHDRAWAL</span></div>
                        <div class="fund-block">
                            <div class="status-block-content">
                                ${{ can_withdraw_balance|floatformat:2  }}
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-md-2" style="width: 20%; padding-right:5px">
                        <div class="block-title"><span>MIN/ MAX</span></div>
                        <div class="block-title"><span>WITHDRAW AMOUNT</span></div>
                        <div class="fund-block">
                            <div class="status-block-content">
                                NO LIMIT
                            </div>
                        </div>
                    </div> -->
                    <div class="col-md-3" >
                        <div class="block-title"><span>&nbsp;</span></div>
                        <div class="block-title"><span>BONUS AMOUNT</span></div>
                        <div class="fund-block">
                            <div class="status-block-content">
                                ${{ bonus_amount|floatformat:2 }}
                            </div>
                        </div>
                    </div>
            </div>
            <div class="col-md-6">
                <div class="block-title"><span></span></div>
                <div class="block-title"><span>BANANCE PER WALLET</span></div>
                <div class="loader"></div>
                <div id="eachWallet" style="display: none;">
                    <div class="col-md-3" style="padding-left: 0px;">
                        <div id="chart5" style="min-height: 135px; "></div>
                    </div>
                    <div class="col-md-9">
                        <div class="row" id="walletData" style="margin-top: 10px; margin-left: 2%">
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <div style="margin-top:10px;margin-left: 15px;">
            <button class="btn btn-primary blockDisable" data-toggle="modal" data-target="#make_adjustment"><span>Make adjustment</span></button>
            <button class="btn btn-primary blockDisable" data-toggle="modal" data-target="#transfer_funds"><span>Transfer funds</span></button>
        </div>

        <div class="modal fade" id="make_adjustment" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header" style="background-color: #489e24; color:white;">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Player adjustment</h4>
                        <div class="update-time">Updated {{ time }}</div>
                    </div>
                    <div class="modal-body">
                        <div style="background-color: #f3f3f3; height: 131px;">
                            <div class="row" style="margin-left:15px; padding-top:15px;">
                                <div class="col-md-4">
                                    <div style="margin-top:5px;">Player ID</div>
                                    <div style="margin-top:5px;">Username</div>
                                    <div style="margin-top:5px;">Main Balance</div>
                                    <div style="margin-top:5px;">Withdraw limit</div>
                                </div>
                                <div class="col-md-8">
                                    <div style="margin-top:5px;">{{ customuser.pk }}</div>
                                    <div style="margin-top:5px;">{{ customuser.username }}</div>
                                    <div style="margin-top:5px;">{{ customuser.main_wallet|floatformat:2 }}</div>
                                    <div style="margin-top:5px;">Not set</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="width:30%; margin-top:20px;">
                            <div for="adjustment_reason" class="edit-member-info-label">Adjustment reason*</div>
                            <select class="form-control" id="adjustment_reason">
                                <option value="-1">Select...</option>
                                <option value="0">Bonus</option>
                                <option value="1">Error</option>
                                <option value="2">Resettlement</option>
                            </select>
                        </div>

                        <div style="margin-top:20px;">
                            <label class="radio-inline">
                                <input type="radio" name="debit-credit" checked value="debit">Debit
                              </label>
                              <label class="radio-inline">
                                <input type="radio" name="debit-credit" value="credit">Credit
                              </label>
                        </div>

                        <div class="form-group" style="width:120px; margin-top:20px !important;">
                            <div class="edit-member-info-label" style="margin-top:0px;">Amount*</div>
                            <input class="form-control" id='adjust_amount' name="amount">
                        </div>

                        <div id="wagering_amount_div" class="form-group" style="width:120px; margin-top:20px !important; display: none">
                            <div class="edit-member-info-label" style="margin-top:0px;">Wagering requirement</div>
                            <div class="input-group">
                                <input id="wagering_amount" type="text" class="form-control" name="wagering_amount">
                                <span class="input-group-addon" style="width: 75px"></span>
                            </div>
                        </div>

                        <!-- <div id="wagering_amount_div" class="form-group" style="display: none; width:120px; margin-top:20px !important;">
                            <input type="text" id="wagering_amount" class="input-front">
                            <input type="text" id="wagering_amount" class="input-behind" disabled>
                        </div> -->

                        <div class="checkbox">
                            <label><input type="checkbox" name="affiliate" value="" id="affiliate">If player is an affiliateâ€™s downline, share the expense with the affiliate.</label>
                        </div>

                        <div class="checkbox">
                            <label><input type="checkbox" name="adjust-notify-player" value="">Notify player of adjustment</label>
                        </div>
                    
                        <div id="message-player" style="display: none;">
                            <div class="form-group">
                                <div class="edit-member-info-label" style="margin-top:20px;">Message subject*</div>
                                <input type="text" class="form-control" id="adjust_message_subject">
                            </div>
                            <div class="form-group">
                                <div class="edit-member-info-label" style="margin-top:20px;" for="message_to_player">Message to player*</div>
                                <textarea class="form-control" rows="5" id="message_to_player"></textarea>
                            </div>
                            
                        </div>
                        
                        <div class="form-group">
                            <div class="edit-member-info-label" style="margin-top:20px;" for="message_note">Reason for adjustment*</div>
                            <textarea class="form-control" rows="3" id="message_note"></textarea>
                        </div>
                        <div style="color: red" id="adjustment_error"></div>
                        <div style="margin-top:20px;" >
                            <button type="submit" id="adjustment-submit" class="btn btn-primary submit-btn" onclick="submitAdjustment();">Save</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                        </div>
                       

                    </div>
                </div> 
            </div>
        </div>

        <div class="modal fade" id="transfer_funds" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header" style="background-color: #489e24; color:white;">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Transfer Fund</h4>
                        <div class="update-time">Updated {{ time }}</div>
                    </div>
                    <div class="modal-body">
                        <div style="background-color: #f3f3f3; height: 120px;">
                            <div class="row" style="margin-left:15px; padding-top:15px;">
                                <div class="col-md-4">
                                    <div style="margin-top:5px;">Player ID</div>
                                    <div style="margin-top:5px;">Username</div>
                                    <div style="margin-top:5px;">Main Balance</div>
                                </div>
                                <div class="col-md-8">
                                    <div style="margin-top:5px;">{{ customuser.pk }}</div>
                                    <div style="margin-top:5px;">{{ customuser.username }}</div>
                                    <div style="margin-top:5px;">{{ customuser.main_wallet|floatformat:2 }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group" style="width:30%; margin-top:20px; display: inline-block;">
                            <div for="transfer_from" class="edit-member-info-label">Transfer from</div>
                            <select class="form-control" id="transfer_from">
                                <option value="-1">Select...</option>
                                <!-- <option value="0">Bonus</option>
                                <option value="1">Error</option>
                                <option value="2">Resettlement</option> -->
                                <option value="main">Main wallet</option>
                                {% for wallet in trans_wallet %}
                                    <option value="{{ wallet.provider_name }}">{{ wallet.provider_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="form-group" style="width:30%; margin-top:20px; display: inline-block; margin-left:10px;">
                            <div for="transfer_to" class="edit-member-info-label">Transfer to</div>
                            <select class="form-control" id="transfer_to">
                                <option value="-1">Select...</option>
                                <option value="main">Main wallet</option>
                                {% for wallet in trans_wallet %}
                                    <option value="{{ wallet.provider_name }}">{{ wallet.provider_name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group" style="width:120px; margin-top:20px !important;">
                            <div class="edit-member-info-label" style="margin-top:0px;">Amount*</div>
                            <input class="form-control" id='transfer_amount' name="amount">
                        </div>

                        <div class="checkbox">
                            <label><input type="checkbox" name="transfer-notify-player" value="">Notify player of fund transfer</label>
                        </div>
                        
                        <div id="transfer-message-player" style="display: none;">
                            <div class="form-group">
                                <div class="edit-member-info-label" style="margin-top:20px;">Message subject*</div>
                                <input type="text" class="form-control" id="transfer_message_subject">
                            </div>

                            <div class="form-group">
                                <div class="edit-member-info-label" style="margin-top:20px;" for="message_to_player">Message to player*</div>
                                <textarea class="form-control" rows="5" id="transfer_message_to_player"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="edit-member-info-label" style="margin-top:20px;" for="message_note">Reason for Transfer*</div>
                            <textarea class="form-control" rows="3" id="transfer_message_note"></textarea>
                        </div>

                        <div style="margin-top:20px;" >
                            <button type="submit" id="transfer-submit" class="btn btn-primary submit-btn" onclick="submitTransfer();">Save</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                        </div>
                       

                    </div>
                </div> 
            </div>
        </div>
    </div>




    <!-- life time value section -->
    <div class="row" id="life-time-rectangle">
        <div class="detail-title-block" style="background-color: #ff6426;">
            <span class="detail-title">Life Time Value</span>
        </div>
        <div class="row" style="margin-top:15px;">
            <div class="col-md-6" >
                <div class="col-md-2" style="padding-right: 1%; width: 20%;">
                    <div class="block-title"><span>&nbsp;</span></div>
                    <div class="block-title"><span>Status</span></div>
                    <div class="life-time-value-block">
                        <div class="block-content" style=" padding-top:25px;">
                            {{ member_status }}
                        </div>
                    </div>
                </div>
                <div class="col-md-2" style="padding-right: 1%; width: 20%;">
                    <div class="block-title"><span>&nbsp;</span></div>
                    <div class="block-title"><span>SEGMENT</span></div>
                    <div class="life-time-value-block">
                        <div class="block-content" id="segment_input">
                            {{ segment }}    
                        </div>
                    </div>
                </div>
                <div class="col-md-2" style="padding-right: 1%; width: 20%;">
                    <div class="block-title"><span>&nbsp;</span></div>
                    <div class="block-title"><span>RISK LEVEL</span></div>
                    <div class="life-time-value-block">
                        <div class="block-content" id="risk_level_input" style="line-height: normal; padding-top: 25%;">
                            {{ riskLevel }}    
                        </div>
                    </div>
                </div>
                <div class="col-md-2" style="padding-right: 1%; width: 20%;">
                    <div class="block-title"><span>WITHDRAWAL/</span></div>
                    <div class="block-title"><span>DEPOSIT</span></div>
                    <div class="life-time-value-block">
                        <div class="block-content">
                            {{ withdrawDepositRate }}%
                        </div>
                    </div>
                </div>
                <div class="col-md-2" style="padding-right: 1%; width: 20%;">
                    <div class="block-title"><span>&nbsp;</span></div>
                    <div class="block-title"><span>BONUS/ DEPOSIT</span></div>
                    <div class="life-time-value-block">
                        <div class="block-content">
                            {{ bonusDepositRate }}%
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-md-6" style="margin-top:6px;">
                <div>
                    <div><span id="contribution-title">CONTRIBUTION PER PRODUCT</span></div>
                </div>
                <div>
                    <div class="pie-chart">
                    </div>
                </div>
                <div class="col-md-10">

                </div>
            </div> -->
            <div class="col-md-6">
                <div class="block-title"><span>&nbsp;</span></div>
                <div class="block-title" style="width: 35%;"><span>CONTRIBUTION PER PRODUCT</span></div>
                <div class="product-loader"></div>
                <div id="eachProduct" style="display: none;">
                    <div class="col-md-3" style="padding-left: 0px;">
                        <div id="chart6" style="min-height: 135px; "></div>
                    </div>
                    <div class="col-md-9">
                        <div class="row" id="productData" style="margin-top: 10px; margin-left: 2%">
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <div class="row" style="margin-top:15px;margin-left: 0px;">
            <div class="col-md-1" style="width: 12.55%; padding-right: 0px;">
                <div class="live-time-value-text">TOTAL GGR</div>
                <div class="active-block">
                    <div class="account-detail">${{ total_ggr }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; padding-right:0px;">
                <div class="live-time-value-text">TOTAL NGR</div>
                <div class="active-block">
                    <div class="account-detail">${{ total_ngr }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%;">
                <div class="live-time-value-text">ACTIVE DAYS</div>
                <div class="active-block">
                    <div class="account-detail">{{ activeTime }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; padding-left:0px; padding-right: 30px;">
                <div class="live-time-value-text">DEPOSIT COUNT</div>
                <div class="active-block">
                    <div class="account-detail">{{ depositCount }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; margin-left: -30px;margin-right: 15px;">
                <div class="live-time-value-text">WITHDRAWAL COUNT</div>
                <div class="active-block">
                    <div class="account-detail">{{ withdrawCount }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; margin-left: -30px;margin-right: 15px;">
                <div class="live-time-value-text">LOGIN COUNT</div>
                <div class="active-block">
                    <div class="account-detail" style="float:left;">{{ loginCount }}</div>
                    <button id="login-btn" type="button" class="btn btn-default" data-toggle="modal" data-target="#login_history"><i class="glyphicon glyphicon-search"></i></button>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; margin-left: -30px;margin-right: 15px;">
                <div class="live-time-value-text">DEPOSIT AMOUNT</div>
                <div class="active-block">
                    <div class="account-detail">${{ depositAmount }}</div>
                </div>
            </div>
            <div class="col-md-1" style="width: 12.55%; margin-left: -30px;margin-right: 15px;">
                <div class="live-time-value-text">WITHDRAWAL AMOUNT</div>
                <div class="active-block">
                    <div class="account-detail">${{ withdrawAmount }}</div>
                </div>
            </div>
        </div>

    </div>

    <!-- memeber detail & activity section -->
    <div class="row" style="margin-top:20px; margin-left:0.3%;">
        <div class="member-detail-rectangle col-md-5">  
            <div class="half-title-block" style="background-color: #ffa313;">
                <span class="detail-title">Member details</span>
            </div>
            <div class="row" style="margin-top:20px; min-height: 380px;">
                <div class='col-md-5' style="margin-left:20px; padding-bottom: 30px;">
                    <input type="hidden" id="hidden_user_id" value="{{ customuser.pk }}"></input>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Member ID</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.pk }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Username</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.username }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Status</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ member_status }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Segment</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ segment }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Risk level</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ riskLevel }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Is affilate</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">
                                {% if customuser.user_to_affiliate_time %}
                                <a href="{% url 'xadmin:agent_detail' customuser.pk %}">Yes</a>
                                {% else %}
                                No
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">First Name</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.first_name }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Last Name</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.last_name }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">ID number</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">ID number</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Email</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.email }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Phone</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.phone }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Birthday</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <span class="detail-info">{{ customuser.date_of_birth }}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <span class="member-detail-label">Address</span>
                        </div>
                        <div class="col-md-6" style="margin-left:-20px;">
                            <div><span class="detail-info">{{ customuser.street_address_1 }}</span></div>
                            <div><span class="detail-info">{{ customuser.street_address_2 }}</span></div>
                            <div><span class="detail-info">{{ customuser.city }}</span></div>
                            <div><span class="detail-info">{{ customuser.zipcode }}</span></div>
                            <div><span class="detail-info">{{ customuser.country }}</span></div>
                        </div>
                    </div>
                </div>
                <div class='col-md-5' style="margin-left:30px">
                    {% if userPhotoId %}
                    <img id="user-photo-id" src="{{ userPhotoId }}">
                    {% else %}
                    <!-- <div id="user-photo-id">None</div> -->
                    <img id="user-photo-id" src="https://www.imagemet.com/wp-content/uploads/2016/12/placeholder.png" alt="User ID Photo">
                    {% endif %}
                    <button id="zoom-btn" class="zoom-btn btn-lg" data-toggle="modal" data-target="#myModal"><i class="fas fa-search-plus"></i></button>
                </div>
                <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: #ffa313; color:white;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">USER PHOTO ID</h4>
                        </div>
                        <div class="modal-body">
                            <img class="showimage img-responsive" src="" />
                        </div>
                    </div>
                    
                </div>
            </div>
            </div>
            <div class="row">
                    <hr>
            </div>
            <div class="row">
                <div class="user-detail-subtitle">LAST ACTIVITY</div>
                <div class="col-md-4" style="margin-left: 15px;margin-right: -20px;">
                    <div class="user-detail-content-title">LOGIN</div>
                    <div class="user-info-block">
                        <div id="member-input-container">
                            <div>
                                <div class="block-title bold">Time</div>
                                <div class="block-text">{{ userLoginObj.time|date:'F d, Y, H:i' }}</div>
                            </div>
                            <div style="margin-top:20px;">
                                <div class="block-title bold">Location</div>
                                <div class="block-text" style="text-transform: capitalize;">{{ userLoginObj.location }}</div>
                            </div>
                            <div style="margin-top:25px;">
                                <div class="block-title bold">IP address</div>
                                <div class="block-text">{{ userLoginObj.ip_address }}</div>
                            </div>
                        </div>
                        <button class="popup-btn" data-toggle="modal" data-target="#login_history"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
                <div class="col-md-4" style="margin-right: -19px;">
                    <div class="user-detail-content-title">DEPOSIT</div>
                    <div class="user-info-block">
                        <div id="member-input-container">
                            <div>
                                <div class="block-title bold">Time</div>
                                {% if lastDeposits.time %}
                                    <div class="block-text">{{ lastDeposits.time }}</div>
                                {% else %}
                                    <div class="block-text">None</div>
                                {% endif %}
                            </div>
                            <div style="margin-top:20px;">
                                <div class="block-title bold">Amount</div>
                                {% if lastDeposits.amount %}
                                    <div class="block-text">{{ lastDeposits.amount }}</div>
                                {% else %}
                                    <div class="block-text">None</div>
                                {% endif %}
                            </div>
                            <div style="margin-top:25px;">
                                <div class="block-title bold">Status</div>
                                {% if lastDeposits.status %}
                                    <div class="block-text">{{ lastDeposits.status }}</div>
                                {% else %}
                                    <div class="block-text">None</div>
                                {% endif %}
                            </div>
                        </div>
                        <button class="popup-btn" onclick='showInitialTransaction("{{ customuser.username }}", "{{ lastDeposits }}", "deposit")' data-toggle="modal" data-target="#trans_deposit_detail"><i class="glyphicon glyphicon-search"></i></button>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="user-detail-content-title">WITHDRAWAL</div>
                        <div class="user-info-block">
                            <div id="member-input-container">
                                <div>
                                    <div class="block-title bold">Time</div>
                                    <div class="block-text">{{ lastWithdraws.time }}</div>
                                </div>
                                <div style="margin-top:20px;">
                                    <div class="block-title bold">Amount</div>
                                    <div class="block-text">{{ lastWithdraws.amount }}</div>
                                </div>
                                <div style="margin-top:25px;">
                                    <div class="block-title bold">Status</div>
                                    <div class="block-text">{{ lastWithdraws.status }}</div>
                                </div>
                            </div>
                            <button class="popup-btn" onclick='showInitialTransaction("{{ customuser.username }}", "{{ lastWithdraws }}", "withdraw")' data-toggle="modal" data-target="#trans_withdrawal_detail"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                </div>                       
            </div>
            <div class="row">
                <hr>
            </div>
            <div class="row">
                <div class="user-detail-subtitle">ACCOUNT CREATION</div>
                <div id="account-creation-rect">
                    <div class="col-md-4">
                        <div style="margin-top:28px;">
                            <div class="block-title">Time</div>
                            <div class="block-text">{{ customuser.time_of_registration|date:'F d, Y, H:i' }}</div>
                        </div>
                        <div style="margin-top:28px;">
                            <div class="block-title">Verification time</div>
                            <div class="block-text">{{ customuser.verification_time|date:'F d, Y, H:i' }}</div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div style="margin-top:28px;">
                            <div class="block-title">Location</div>
                            {% if customuser.id_location %}
                                <div class="block-text">{{ customuser.id_location }}</div>
                            {% else %}
                                <div class="block-text">None</div>
                            {% endif %}
                        </div>
                        <div style="margin-top:28px;">
                            <div class="block-title">First deposit</div>
                            <div class="block-text">{{ customuser.ftd_time|date:'F d, Y, H:i' }}</div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div style="margin-top:28px;">
                            <div class="block-title">IP address</div>
                            <div class="block-text">{{ create_account_ip }}</div>
                        </div>
                        <div style="margin-top:28px;">
                            <div class="block-title">Source</div>
                            <div class="block-text">{{ customuser.get_user_attribute_display }}</div>
                        </div>
                    </div>
                </div>
            </div>
                    
            <div class='row'>
                <button id="edit-detail-btn" type="button" class="btn btn-primary blockDisable" data-toggle="modal" data-target="#edit_details">Edit details</button>
            </div>
            
            <!-- edit member detail window -->
            <div class="modal fade" id="edit_details" role="dialog">
                <div class="modal-dialog">
                
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: #ffa313; color:white">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Edit member details</h4>
                            <!-- <h6 style="float: right;">Update Time:</h6> -->
                        </div>
                        <div class="modal-body">
                            <form action="{% url 'xadmin:user_detail' %}" method="POST" id="edit-member-form">
                                <div class='row'>
                                
                                    {% csrf_token %}
                                    <div class='col-md-6'>
                                        <input type="hidden" name="type" value="edit_user_detail"></input>
                                        <input type="hidden" name="user_id" value="{{ customuser.pk }}"></input>
                                        <div class="form-group">
                                            <div for="member_id" class="edit-member-info-label" style="margin-top:0px;">MEMBER ID</div>
                                            <input class="form-control" id='member_id' name="member_id" value="{{ customuser.pk }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="username" class="edit-member-info-label">USERNAME</div>
                                            <input class="form-control" id='username' name="username" value="{{ customuser.username }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="first_name" class="edit-member-info-label">FIRST NAME</div>
                                            <input class="form-control" name="first_name" value="{{ customuser.first_name }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="last_name" class="edit-member-info-label">LAST NAME</div>
                                            <input class="form-control" name="last_name" value="{{ customuser.last_name }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="last_name" class="edit-member-info-label">ID NUMBER</div>
                                            <input class="form-control" name="id_number" value="{{ customuser.id_number }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="date_of_birth" class="edit-member-info-label">BIRTHDAY</div>
                                            <input class="form-control" name="date_of_birth" value="{{ customuser.date_of_birth }}">
                                        </div>
                                        <div class="form-group">
                                            <div for="member_status" class="edit-member-info-label">STATUS</div>
                                            <select class="form-control" name="member_status">
                                                <option {% if customuser.member_status == 0 %} selected="selected"{% endif %} value="0">Normal</option>
                                                <option {% if customuser.member_status == 1 %} selected="selected"{% endif %} value="1">Suspicious</option>
                                                <option {% if customuser.member_status == 2 %} selected="selected"{% endif %} value="2">Restricted</option>
                                                <option {% if customuser.member_status == 3 %} selected="selected"{% endif %} value="3">Closed</option>
                                                <option {% if customuser.member_status == 4 %} selected="selected"{% endif %} value="3">Blacklist</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <div for="player_segment" class="edit-member-info-label">PLAYER SEGMENT</div>
                                            <select class="form-control">
                                                <option value="-1"  {% if segment == None %} selected="selected"{% endif %}>Select....</option>
                                                {% for i in segment_level %}
                                                    <option value="{{ i.pk }}" {% if segment == i.level %} selected="selected"{% endif %}>{{ i.level }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <div for="risk_level" class="edit-member-info-label" name="risk_level">RISK LEVEL</div>
                                            <select class="form-control">
                                                <option value="0" {% if customuser.risk_level == 0 %} selected="selected"{% endif %}>Very High</option>
                                                <option value="1" {% if customuser.risk_level == 1 %} selected="selected"{% endif %}>High</option>
                                                <option value="2" {% if customuser.risk_level == 2 %} selected="selected"{% endif %}>Medium</option>
                                                <option value="3" {% if customuser.risk_level == 3 %} selected="selected"{% endif %}>Low</option>
                                                <option value="4" {% if customuser.risk_level == 4 %} selected="selected"{% endif %}>Very Low</option>
                                                <option value="5" {% if customuser.risk_level == 5 %} selected="selected"{% endif %}>VIP</option>
                                                <option value="6" {% if customuser.risk_level == 6 %} selected="selected"{% endif %}>Business</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <div for="email" class="edit-member-info-label" style="display: inline-table;">
                                                <div style="float: left;">EMAIL</div>
                                                {% if customuser.email_verified %}
                                                <div style="float: right;">Verified</div>
                                                {% else %}
                                                <div style="float: right;">Not Verified</div>
                                                {% endif %}
                                            </div>
                                            <input type='email' id='email' class="form-control" name="email" value="{{ customuser.email }}">
                                        </div>
                                        <div class="form-group">
                                            <!-- <div for="phone" class="edit-member-info-label">PHONE</div> -->
                                            <div for="phone" class="edit-member-info-label" style="display: inline-table;">
                                                <div style="float: left;">PHONE</div>
                                                {% if customuser.phone_verified %}
                                                <div style="float: right;">Verified</div>
                                                {% else %}
                                                <div style="float: right;">Not Verified</div>
                                                {% endif %}
                                            </div>
                                            <input class="form-control" id='phone' name="phone" value="{{ customuser.phone }}">
                                        </div>
                                        
                                        <div class="form-group">
                                            <!-- <div for="address" class="edit-member-info-label">ADDRESS</div> -->
                                            <div for="address" class="edit-member-info-label" style="display: inline-table;">
                                                <div style="float: left;">ADDRESS</div>
                                                {% if customuser.address_verified %}
                                                <div style="float: right;">Verified</div>
                                                {% else %}
                                                <div style="float: right;">Not Verified</div>
                                                {% endif %}
                                            </div>
                                            <input class="form-control" name="street_address_1" style="height: 140px;" value="{{ customuser.street_address_1 }}">
                                            <div class="row" style="margin-top: 8px;">
                                                <div class="col-md-7" style="padding-right: 0px;">
                                                    <input class="form-control" name="city" value="{{ customuser.city }}">
                                                </div>
                                                <div class="col-md-5" style="padding-left: 5px;">
                                                    <input class="form-control" name="zipcode" value="{{ customuser.zipcode }}">
                                                </div>
                                            </div>
                                            <div style="margin-top: 8px;">
                                                <input class="form-control" name="country" value="{{ customuser.country }}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <input id='hidden_input_img' type='file' accept='image/*' style='display: none;' onchange="chooseFile(event);">
                                        {% if userPhotoId %}
                                        <img id="user-photo-img" src="{{ userPhotoId }}">
                                        <!-- user_image_log_obj -->
                                        <div class="row" style="margin: 0px;">
                                            <div class='col-md-6 edit-member-image-label bold'>Time of application</div>
                                            <div class='col-md-6 edit-member-image-label'>{{ user_image_log_obj.created_time }}</div>
                                        </div>
                                        <div class="row" style="margin: 0px;">
                                            <div class='col-md-6 edit-member-image-label bold'>Time of review</div>
                                            <div class='col-md-6 edit-member-image-label'>{{ user_image_log_obj.created_time }}</div>
                                        </div>
                                        <div class="row" style="margin: 0px;">
                                            <div class='col-md-6 edit-member-image-label bold'>Reviewer</div>
                                            <div class='col-md-6 edit-member-image-label'>{{ user_image_log_obj.admin.username }}</div>
                                        </div>
                                        {% else %}
                                        <img id="user-photo-img" src="https://www.imagemet.com/wp-content/uploads/2016/12/placeholder.png" alt="User ID Photo">
                                        {% endif %}
                                        <input type="hidden" name='user_id_img_first' value="false">
                                        <input type="hidden" name='user_id_img' id="hidden_user_id_url">
                                        <div>&nbsp;</div>
                                        <div class="row">
                                            <div class='col-md-8'>
                                                <button type="button" class="btn btn-primary" onclick="clickUploadImg();">Upload new document</button>
                                            </div>
                                            <div class='col-md-4'>
                                                <button type="button" class="btn btn-default" style="background-color:rgb(199, 89, 82)" onclick="clearImg();">
                                                    <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                                </button>
                                            </div>
                                        </div>
                                    </div>                          
                                </div>
                                <div>
                                    <div class="form-group">
                                        <div class="edit-member-info-label">REASON FOR CHANGES*</div>
                                        <textarea class="form-control" id="reasonTextarea" name="reason_text" rows="3" placeholder="Please provide a brief explanation."></textarea>
                                    </div>

                                    {% if customuser.block == False %}
                                    <div>
                                        <button type="button" id="close-account-btn" class="btn btn-danger" style="margin-top: 20px;">
                                            <span class="glyphicon glyphicon-trash" style="color:white; padding-right: 20%; margin-left: -5px;"></span>Close account
                                        </button>
                                    </div>
                                    {% else %}
                                    <div>
                                        <button type="button" id="open-account-btn" class="btn btn-success" style="margin-top: 20px;" onclick="userBlockAction('open')">
                                            Open account
                                        </button>
                                    </div>
                                    {% endif %}
                                    <p id='errorMessage'>&nbsp;</p>
                                    <button type="submit" id="submitButton" class="btn btn-primary submit-btn">Save</button>
                                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                                </div>  
                            </form>
                        </div>
                        <!-- <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div> -->
                    </div>
                    
                </div>
            </div>

            <!-- login history window -->
            <div class="modal fade" id="login_history" role="dialog">
                    <div class="modal-dialog">
                    
                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header" style="background-color: #ffa313; color:white;">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">Login history</h4>
                                <div class="update-time">Updated {{ time }}</div>
                            </div>
                            <div class="modal-body">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                        <th scope="col">Time</th>
                                        <th scope="col">Location</th>
                                        <th scope="col">IP address</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for login in userLoginActions %}
                                        <tr>
                                        <td>{{ login.created_time }}</td>
                                        <td>Location</td>
                                        <td>{{ login.ip_addr }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            <!-- <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div> -->
                        </div> 
                    </div>
            </div>

            <!-- deposit popup window -->
            <div class="modal fade" id="trans_deposit_detail" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: #489e24; color:white;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Deposit Detail</h4>
                            <div class="update-time">Updated {{ time }}</div>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-5">
                                    <p>Client Name </p>
                                    <p>Transaction Number </p>
                                    <p>Time of application </p>
                                    <p>Account Time </p>
                                    <p>Approver </p>
                                    <p>Bank/Branch </p>
                                    <p>Receive Bank </p>
                                    <p>Apply amount </p>
                                    <p>Arrive amount </p>
                                    <p>Status </p>
                                </div>
                                <div class="col-md-7" id="deposit-detail">
                                    <p>{{ customuser.username }}</p>
                                    <p>{{ trans.transactionId }}</p>
                                    <p>{{ trans.time }}</p>
                                    <p>{{ trans.time }}</p>
                                    <p>/</p>
                                    <span>{{ trans.channel }} </span><span>{{ trans.method }}</span>
                                    <p>/</p>
                                    <p>{{ trans.amount }}</p>
                                    <p>{{ trans.amount }}</p>
                                    <p>{{ trans.status }}</p>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>

            <!-- withdraw popup window -->
            <div class="modal fade" id="trans_withdrawal_detail" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: #489e24; color:white;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Withdrawal Detail</h4>
                            <div class="update-time">Updated {{ time }}</div>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-5">
                                    <p>Client Name </p>
                                    <p>Transaction Number </p>
                                    <p>Time of application </p>
                                    <p>Account Time </p>
                                    <p>Bank/Branch </p>
                                    <p>Receive Bank </p>
                                    <p>Assignment error</p>
                                    <p>Bank Account</p>
                                    <p>Channel Name</p>
                                    <p>Apply amount </p>
                                    <p>Arrive amount </p>
                                    <p>Surcharge </p>
                                    <p>Time of Audit </p>
                                    <p>Auditor </p>
                                    <p>Audi Memo </p>
                                    <p>Status </p>
                                </div>
                                <div class="col-md-7" id="withdraw-detail">
                                    <p>{{ customuser.username }}</p>
                                    <p>{{ trans.transactionId }}</p>
                                    <p>{{ trans.time }}</p>
                                    <p>{{ trans.time }}</p>
                                    <span>{{ trans.channel }} </span><span>{{ trans.method }}</span>
                                    <p>/</p>
                                    <p>/</p>
                                    <p>/</p>
                                    <p>{{ trans.channel }} </p>
                                    <p>{{ trans.amount }}</p>
                                    <p>{{ trans.amount }}</p>
                                    <p>fee</p>
                                    <p>/</p>
                                    <p>/</p>
                                    <p>/</p>
                                    <p>{{ trans.status }}</p>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>
            
            <!-- bet history popup window-->
            <div class="modal fade" id="trans_bet_placed_detail" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: #489e24; color:white;">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Bet Detail</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <p>Player Name </p>
                                    <p>Transaction Number </p>
                                    <p>Time of Bet </p>
                                    <p>Amount Won</p>
                                    <p>Amount Wagered</p>
                                    <p>Resolved Time</p>
                                    <p>Outcome</p>
                                    <p>Status </p>
                                </div>
                                <div class="col-md-8" id="bet_history_detail">
                                    <!-- <p>{{ customuser.username }}</p>
                                    <p>{{ trans.transactionId }}</p>
                                    <p>{{ trans.time }}</p>
                                    <p>{{ trans.time }}</p>
                                    <p></p>
                                    <p>{{ trans.channel }} </p><p>{{ trans.method }}</p>
                                    <p>/</p>
                                    <p>{{ trans.amount }}</p>
                                    <p>{{ trans.amount }}</p>
                                    <p>{{ trans.status }}</p> -->
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>
            </div>
            
        </div>
        <div class="activity-rectangle col-md-5">  
            <div class="half-title-block" style="background-color: #588ebd;">
                <span class="detail-title">Activity</span>
            </div>
            <div class="form-group" style="padding:20px 0px 20px 0px; margin-left:25px;">
                <div><span class="block-title">ACTIVITY TYPE</span></div>
                <div style="width:165px;"><select class="form-control" id="activity-select">
                        <option value="all">All activity</option>
                        <option value="0">Operation</option>
                        <option value="1">Remark</option>
                        <option value="2">Chat</option>
                        <option value="3">Note</option>
                    </select>
                </div>
            </div>
            <div id="select-filter" style="border-top: 1px solid; overflow-y: auto; height:898px;">
                {% for act in activity %}
                    <div class="note-author">
                        {% if act.activity_type == 0 %}
                            <i class="fas fa-cog" style="margin-right: 10px;"></i>
                        {% elif act.activity_type == 1 %}
                            <i class="far fa-edit" style="margin-right: 10px;"></i>
                        {% elif act.activity_type == 2 %}
                            <i class="far fa-envelope" style="margin-right: 10px;"></i>
                        {% elif act.activity_type == 3 %}
                            <i class="far fa-comments" style="margin-right: 10px;"></i>
                        {% endif %}
                        {{ act.admin }} {{ act.created_time }} 
                    </div>
                    <div class="note-block">
                        <div style="padding: 14px 28px;">
                            {% if act.system_message and act.system_message|length > 0  %}
                            <div>
                                {{ act.system_message }}
                            </div>
                            {% endif %}
                            {% if act.message and act.message|length > 0  %}
                            <div>
                                Reason: {{ act.message }}
                            </div>
                            {% endif %}
                        </div> 
                    </div>
                {% endfor %}
            </div>
            <div id="note-input-container">
                <button id="note-btn" class="btn btn-primary blockDisable"><i class="fa fa-paperclip" aria-hidden="true"></i></button>
                <input type="text" class="form-control" id="notes-input" placeholder="Write a new note...">
                <button class="btn btn-primary blockDisable" id="post-btn">Post</button>
            </div>
        </div>
    </div>

    <!-- transaction section -->
    <div class="row" id="transaction-rectangle">
        <div class="detail-title-block" style="background-color: #489e24;">
            <span class="detail-title">Transaction History</span>
        </div>
        <div class="container nav-bar">
            <ul class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#transaction">Transaction</a></li>
                <li><a data-toggle="tab" href="#bet_history">Bet History</a></li>
            </ul>
            <div class="tab-content">
                <div id="transaction" class="tab-pane fade in active">
                    <div class="row" style="margin-top:20px;">
                        <div class="col-md-6" >
                            <div class='col-md-8'>
                                <div class="row">
                                    <div class='col-md-6'>
                                        <div class="block-title">PRODUCT</div>
                                        <select class="form-control" id="transaction_product_select">
                                            <option value="all">All products</option>
                                            <option value="0">Sports</option>
                                            <option value="1">Games</option>
                                            <option value="2">Live Casino</option>
                                            <option value="3">Table Game</option>
                                            <option value="5">Lottory</option>
                                        </select>
                                    </div>
                                    <div class='col-md-6'>
                                        <div class="block-title">CATEGORY</div>
                                        <select class="form-control" id="transaction_category_select">
                                            <option value="all">All transactions</option>
                                            <option value="0">Deposit</option>
                                            <option value="1">Withdraw</option>
                                            <option value="4">Transfer</option>
                                            <option value="5">Bonus</option>
                                            <option value="6">Adjustment</option>
                                            <option value="7">Commission</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-5" style="margin-right: -8%; float: right;">
                            <div class="block-title">DATE RANGE</div>
                            <div class="row">
                                <div class='col-md-4' style="padding-right: 0px;">
                                    <div class='input-group date' id='transaction_time_from'>
                                        <input type='text' class="form-control" placeholder="From" id='transaction_time_from_input' />
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                    </div>
                                </div>
                                <div class='col-md-4'>
                                    <div class='input-group date' id='transaction_time_to'>
                                        <input type='text' class="form-control" placeholder="To"  id='transaction_time_to_input'/>
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                    </div>
                                </div>
                                <div class='col-md-2' style="padding-left: 0px;">
                                    <button type="submit" id="transaction_time_submit" class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <label style="margin:15px">TRNASACTION LAST 7 DAYS</label> -->
                    <div class="row" style="margin:2% 1% 2% 1%;">
                        <table id="transaction-table">
                            <thead class="thead-dark">
                                <tr>
                                    <th style="width:8%;">CATEGORY</th>
                                    <th style="width:8%;">PRODUCT</th>
                                    <th scope="col">TRANSACTION NO.</th>
                                    <th style="width:6%;">FROM WALLET</th>
                                    <th style="width:6%;">TO WALLET</th>
                                    <th style="width:6%;">CURRENCY</th>
                                    <th style="width:14%;">TIME</th>
                                    <th style="width:6%;">AMOUNT</th>
                                    <th style="width:6%;">BALANCE</th>
                                    <th style="width:7%;">STATUS</th>
                                    <th style="width:3%;"></th>
                                </tr>
                            </thead>
                            <tbody id="transaction_tbody">
                                {% for trans in userTransactions %} 
                                <tr>
                                    <td>{{ trans.category }}</td>
                                    <td>{{ trans.product }}</td>
                                    <td>{{ trans.transactionId }}</td>
                                    <td>{{ trans.fromWallet }}</td>
                                    <td>{{ trans.toWallet }}</td>
                                    <td>{{ trans.currency }}</td>
                                    <td id="requestTime">{{ trans.time }}</td>
                                    <td>{{ trans.amount }}</td>
                                    <td>{{ trans.balance }}</td>
                                    <td>{{ trans.status }}</td>
                                    {% if trans.transTypeCode == 0 %}
                                    <td><button type="button" class="btn btn-primary" onclick='showInitialTransaction("{{ customuser.username }}", "{{ trans }}", "deposit")' data-toggle="modal" data-target="#trans_deposit_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 1 %}
                                    <td><button type="button" class="btn btn-primary" onclick='showInitialTransaction("{{ customuser.username }}", "{{ trans }}", "withdraw")' data-toggle="modal" data-target="#trans_withdrawal_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 2 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_placed_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 3 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_settled_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 4 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_trans_in_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 5 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_trans_out_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 6 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bonus_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% elif trans.transTypeCode == 7 %}
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_adjustment_detail"><span class="glyphicon glyphicon-search"></span></button></td>
                                    {% endif %}
                                </tr>

                                <div class="modal fade" id="trans_bet_placed_detail" role="dialog">
                                        <div class="modal-dialog">
                                            <!-- Modal content-->
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    <h4 class="modal-title">Deposit Detail</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <p>Client Name </p>
                                                            <p>Transaction Number </p>
                                                            <p>Time of application </p>
                                                            <p>Account Time </p>
                                                            <p>Approver </p>
                                                            <p>Bank/Branch </p>
                                                            <p>Receive Bank </p>
                                                            <p>Apply amount </p>
                                                            <p>Arrive amount </p>
                                                            <p>Status </p>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <p>{{ customuser.username }}</p>
                                                            <p>{{ trans.transactionId }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p></p>
                                                            <p>{{ trans.channel }} </p><p>{{ trans.method }}</p>
                                                            <p>/</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.status }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                </div>
                                <div class="modal fade" id="trans_bet_settled_detail" role="dialog">
                                        <div class="modal-dialog">
                                            <!-- Modal content-->
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    <h4 class="modal-title">Deposit Detail</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <p>Client Name </p>
                                                            <p>Transaction Number </p>
                                                            <p>Time of application </p>
                                                            <p>Account Time </p>
                                                            <p>Approver </p>
                                                            <p>Bank/Branch </p>
                                                            <p>Receive Bank </p>
                                                            <p>Apply amount </p>
                                                            <p>Arrive amount </p>
                                                            <p>Status </p>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <p>{{ customuser.username }}</p>
                                                            <p>{{ trans.transactionId }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p></p>
                                                            <p>{{ trans.channel }} </p><p>{{ trans.method }}</p>
                                                            <p>/</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.status }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                </div>
                                {% endfor %}
                            </tbody>
                        </table>
                        <div class="row">
                            <div class='col-md-1'>
                                <button class="btn btn-primary"><span>Export</span></button>
                            </div>
                            <div class="transaction-control-group col-md-9"></div>
                            <div>
                                <div class='col-md-1'>
                                <!-- <div class='col-md-1'> -->
                                    <input type="hidden" id="hidden_row" value="0"></input>
                                    <select id="pagination_value"  class="form-control">
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                        <option value="250">250</option>
                                    </select>
                                </div>
                                <div class='col-md-1'>
                                    <ul class="pagination" style="margin:0px;">
                                        <li class="page-item disabled" id='previousPage'>
                                        <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                        </li>
                                        {% if isLastPage is True %}
                                        <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                        {% else %}
                                        <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="bet_history" class="tab-pane fade">
                    <div class="row" style="margin-top:20px;">
                        <div class="col-md-6" >
                            <div class='col-md-8'>
                                <div class="row">
                                    <div class='col-md-6'>
                                        <div class="block-title">PRODUCT</div>
                                        <select class="form-control" id="bet_product_select">
                                            <option value="all">All products</option>
                                            <option value="Sports">Sports</option>
                                            <option value="Games">Games</option>
                                            <option value="Live Casino">Live Casino</option>
                                            <option value="Table Game">Table Game</option>
                                            <option value="Lottory">Lottory</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-5" style="margin-right: -8%; float: right;">
                            <div class="block-title">DATE RANGE</div>
                            <div class="row">
                                <div class='col-md-4' style="padding-right: 0px;">
                                    <div class='input-group date' id='bet_time_from'>
                                        <input type='text' class="form-control" placeholder="From" id='bet_time_from_input' />
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                    </div>
                                </div>
                                <div class='col-md-4'>
                                    <div class='input-group date' id='bet_time_to'>
                                        <input type='text' class="form-control" placeholder="To"  id='bet_time_to_input'/>
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                    </div>
                                </div>
                                <div class='col-md-2' style="padding-left: 0px;">
                                    <button type="submit" id="bet_time_submit"  class="btn btn-primary"><span class="glyphicon glyphicon-search"></span></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <label style="margin:15px">TRNASACTION LAST 7 DAYS</label> -->
                    <div class="row" style="margin:2% 1% 2% 1%;">
                        <table id="transaction-table">
                            <thead class="thead-dark">
                                <tr>
                                    <th style="width:8%;">CATEGORY</th>
                                    <th style="width:8%;">PRODUCT</th>
                                    <th scope="col">TRANSACTION NO.</th>
                                    <th style="width:6%;">AMOUNT WAGERED</th>
                                    <th style="width:6%;">AMOUNT WIN</th>
                                    <th style="width:6%;">CURRENCY</th>
                                    <th style="width:14%;">BET TIME</th>
                                    <th style="width:7%;">STATUS</th>
                                    <th style="width:3%;"></th>
                                </tr>
                            </thead>
                            <tbody id="bet_history_tbody">
                                {% for history in userBetHistory %} 
                                <tr>
                                    <td>{{ history.category }}</td>
                                    <td>{{ history.product }}</td>
                                    <td>{{ history.transactionId }}</td>
                                    <td>{{ history.amount_wagered }}</td>
                                    <td>{{ history.amount_won }}</td>
                                    <td>{{ history.currency }}</td>
                                    <td >{{ history.time }}</td>
                                    <td>{{ history.status }}</td>
                                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_placed_detail" onclick="viewBetInfo('{{ history.pk }}')" ><span class="glyphicon glyphicon-search"></span></button></td>
                                </tr>
                                <div class="modal fade" id="trans_bet_settled_detail" role="dialog">
                                        <div class="modal-dialog">
                                            <!-- Modal content-->
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                    <h4 class="modal-title">Deposit Detail</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <p>Client Name </p>
                                                            <p>Transaction Number </p>
                                                            <p>Time of application </p>
                                                            <p>Account Time </p>
                                                            <p>Approver </p>
                                                            <p>Bank/Branch </p>
                                                            <p>Receive Bank </p>
                                                            <p>Apply amount </p>
                                                            <p>Arrive amount </p>
                                                            <p>Status </p>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <p>{{ customuser.username }}</p>
                                                            <p>{{ trans.transactionId }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p>{{ trans.time }}</p>
                                                            <p></p>
                                                            <p>{{ trans.channel }} </p><p>{{ trans.method }}</p>
                                                            <p>/</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.amount }}</p>
                                                            <p>{{ trans.status }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                </div>
                                {% endfor %}
                            </tbody>
                        </table>
                        <div class="row">
                            <div class='col-md-1'>
                                <button class="btn btn-primary"><span>Export</span></button>
                            </div>
                            <div class="transaction-control-group col-md-9"></div>
                            <div>
                                <div class='col-md-1'>
                                <!-- <div class='col-md-1'> -->
                                    <input type="hidden" id="bet_hidden_row" value="0"></input>
                                    <select id="bet_pagination_value"  class="form-control">
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                        <option value="250">250</option>
                                    </select>
                                </div>
                                <div class='col-md-1'>
                                    <ul class="pagination" style="margin:0px;">
                                        <li class="page-item disabled" id='previousBetPage'>
                                        <a class="page-link" href="javascript:getBetPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                        </li>
                                        {% if betIsLastPage is True %}
                                        <li class="page-item disabled" id='nextBetPage'><a class="page-link" href="javascript:getBetNext();"><i class='fas fa-caret-right'></i></a></li>
                                        {% else %}
                                        <li class="page-item" id='nextBetPage'><a class="page-link" href="javascript:getBetNext();"><i class='fas fa-caret-right'></i></a></li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div> 
    </div>
    
    <!-- risk control section -->
    <div class="row" id="risk-control-rectangle">
        <div class="detail-title-block" style="background-color: #9aa0d0;">
            <span class="detail-title">Risk control</span>
        </div>
        <div class="container nav-bar">
            <ul class="nav nav-tabs ">
                <li class="active"><a data-toggle="tab" href="#related-account">RELATED ACCOUNTS</a></li>
                <li><a data-toggle="tab" href="#related-device">RELATED DEVICE</a></li>
                <li><a data-toggle="tab" href="#deposit-withdraw">DEPOSIT / WITHDRAWAL</a></li>
                <li><a data-toggle="tab" href="#winloss-bonus">WINLOSS / BONUS</a></li>
            </ul>
            <div class="tab-content">
                <div id="related-account" class="tab-pane fade in active">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                            <th scope="col">#</th>
                            <th scope="col">MEMBER</th>
                            <th scope="col">CHANNEL</th>
                            <th scope="col">SOURCE</th>
                            <th scope="col">DEPOSIT</th>
                            <th scope="col">BONUS / TURNOVER</th>
                            <th scope="col">WITHDRAWAL</th>
                            <th scope="col">CONTRIBUTION</th>
                            <th scope="col">RISK LEVEL</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if relativeAccount%}
                                {% for account in relativeAccount %}
                                <tr>
                                    <td scope="row">{{ forloop.counter }}</td>
                                    <td><a href="{% url 'xadmin:user_detail' account.id %}">{{ account.username }}</td>
                                    <td>{{ account.source }}</td>
                                    <td>{{ account.channel }}</td>
                                    <td>{{ account.deposit }}</td>
                                    <td>{{ account.turnover }}</td>
                                    <td>{{ account.withdrawal }}</td>
                                    <td>{{ account.contribution }}</td>
                                    <td>{{ account.riskLevel }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                            {% endif %}
                        </tbody>
                    </table>
                    <div class="row">
                        <div class='col-md-1'>
                            <button class="btn btn-primary"><span>Export</span></button>
                        </div>
                        <div class="transaction-control-group col-md-9"></div>
                        <div>
                            <div class='col-md-1'>
                            <!-- <div class='col-md-1'> -->
                                <input type="hidden" id="hidden_row" value="0"></input>
                                <select id="pagination_value"  class="form-control">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                </select>
                            </div>
                            <div class='col-md-1'>
                                <ul class="pagination" style="margin:0px;">
                                    <li class="page-item disabled" id='previousPage'>
                                    <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                    </li>
                                    {% if isLastPage is True %}
                                    <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% else %}
                                    <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="related-device" class="tab-pane fade">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                            <th scope="col">#</th>
                            <th scope="col">Device Number</th>
                            <th scope="col">Location</th>
                            <th scope="col">Count</th>
                            <th scope="col">Percentage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- {% for account in relativeAccount %} -->
                            <tr>
                                <td scope="row">{{ forloop.counter }}</td>
                                <td>test data</td>
                                <td>test data</td>
                                <td>test data</td>
                                <td>test data</td>
                            </tr>
                            <!-- {% endfor %} -->
                        </tbody>
                    </table>
                    <div class="row">
                        <div class='col-md-1'>
                            <button class="btn btn-primary"><span>Export</span></button>
                        </div>
                        <div class="transaction-control-group col-md-9"></div>
                        <div>
                            <div class='col-md-1'>
                            <!-- <div class='col-md-1'> -->
                                <input type="hidden" id="hidden_row" value="0"></input>
                                <select id="pagination_value"  class="form-control">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                </select>
                            </div>
                            <div class='col-md-1'>
                                <ul class="pagination" style="margin:0px;">
                                    <li class="page-item disabled" id='previousPage'>
                                    <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                    </li>
                                    {% if isLastPage is True %}
                                    <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% else %}
                                    <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="deposit-withdraw" class="tab-pane fade">
                    <canvas id="deposit-withdraw-chart"></canvas>
                </div>
                <div id="winloss-bonus" class="tab-pane fade">
                    <canvas id="winloss-bonus"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- bonus section -->

    <div class="row" id="bonus-control-rectangle">
        <div class="detail-title-block" style="background-color: #e26a6b;">
            <span class="detail-title">Bonus history</span>
        </div>
        <div class="container nav-bar">
            <ul class="nav nav-tabs ">
                <li class="active"><a data-toggle="tab" href="#bonus-active">ACTIVE</a></li>
                <li><a data-toggle="tab" href="#bonus-complete">COMPLETED</a></li>
                <li><a data-toggle="tab" href="#bonus-cancelled">CANCELLED</a></li>
            </ul>
            <div class="tab-content">
                <div id="bonus-active" class="tab-pane fade in active">
                    <div class="row" style="margin-top:30px;">
                        <div class="col-md-2">
                            <div class="block-title">BONUS TYPE</div>
                            <select class="form-control" id="transaction_product_select">
                                <option value="all">All bonuses</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                            </select>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                            <th scope="col">#</th>
                            <th scope="col">BONUS NAME</th>
                            <th scope="col">BONUS TYPE</th>
                            <th scope="col">TIME OF APPLICATION</th>
                            <th scope="col">TIME RECEIVED</th>
                            <th scope="col">AMOUNT</th>
                            <th scope="col">WITHDRAW LIMITATION</th>
                            <th scope="col">COMPLETION</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if relativeAccount%}
                                {% for account in relativeAccount %}
                                <tr>
                                    <td scope="row">{{ forloop.counter }}</td>
                                    <td><a href="{% url 'xadmin:user_detail' account.id %}">{{ account.username }}</td>
                                    <td>{{ account.source }}</td>
                                    <td>{{ account.channel }}</td>
                                    <td>{{ account.deposit }}</td>
                                    <td>{{ account.turnover }}</td>
                                    <td>{{ account.withdrawal }}</td>
                                    <td>{{ account.contribution }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                            {% endif %}
                        </tbody>
                    </table>
                    <div class="row">
                        <div class='col-md-1'>
                            <button class="btn btn-primary"><span>Export</span></button>
                        </div>
                        <div class="transaction-control-group col-md-9"></div>
                        <div>
                            <div class='col-md-1'>
                            <!-- <div class='col-md-1'> -->
                                <input type="hidden" id="hidden_row" value="0"></input>
                                <select id="pagination_value"  class="form-control">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                </select>
                            </div>
                            <div class='col-md-1'>
                                <ul class="pagination" style="margin:0px;">
                                    <li class="page-item disabled" id='previousPage'>
                                    <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                    </li>
                                    {% if isLastPage is True %}
                                    <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% else %}
                                    <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="bonus-complete" class="tab-pane fade">
                    <div class="row" style="margin-top:30px;">
                        <div class="col-md-2">
                            <div class="block-title">BONUS TYPE</div>
                            <select class="form-control" id="transaction_product_select">
                                <option value="all">All bonuses</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                            </select>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered">
                        <thead>
                                <tr>
                                <th scope="col">#</th>
                                <th scope="col">BONUS NAME</th>
                                <th scope="col">BONUS TYPE</th>
                                <th scope="col">TIME OF APPLICATION</th>
                                <th scope="col">TIME RECEIVED</th>
                                <th scope="col">AMOUNT</th>
                                <th scope="col">WITHDRAW LIMITATION</th>
                                <th scope="col">COMPLETION</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if relativeAccount%}
                                    {% for account in relativeAccount %}
                                    <tr>
                                        <td scope="row">{{ forloop.counter }}</td>
                                        <td><a href="{% url 'xadmin:user_detail' account.id %}">{{ account.username }}</td>
                                        <td>{{ account.source }}</td>
                                        <td>{{ account.channel }}</td>
                                        <td>{{ account.deposit }}</td>
                                        <td>{{ account.turnover }}</td>
                                        <td>{{ account.withdrawal }}</td>
                                        <td>{{ account.contribution }}</td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                {% endif %}
                            </tbody>
                        </thead>
                    </table>
                    <div class="row">
                        <div class='col-md-1'>
                            <button class="btn btn-primary"><span>Export</span></button>
                        </div>
                        <div class="transaction-control-group col-md-9"></div>
                        <div>
                            <div class='col-md-1'>
                            <!-- <div class='col-md-1'> -->
                                <input type="hidden" id="hidden_row" value="0"></input>
                                <select id="pagination_value"  class="form-control">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                </select>
                            </div>
                            <div class='col-md-1'>
                                <ul class="pagination" style="margin:0px;">
                                    <li class="page-item disabled" id='previousPage'>
                                    <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                    </li>
                                    {% if isLastPage is True %}
                                    <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% else %}
                                    <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="bonus-cancelled" class="tab-pane fade">
                    <div class="row" style="margin-top:30px;">
                        <div class="col-md-2">
                            <div class="block-title">BONUS TYPE</div>
                            <select class="form-control" id="transaction_product_select">
                                <option value="all">All bonuses</option>
                                <option value="0">0</option>
                                <option value="1">1</option>
                            </select>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                            <th scope="col">#</th>
                            <th scope="col">BONUS NAME</th>
                            <th scope="col">BONUS TYPE</th>
                            <th scope="col">TIME OF APPLICATION</th>
                            <th scope="col">TIME RECEIVED</th>
                            <th scope="col">AMOUNT</th>
                            <th scope="col">WITHDRAW LIMITATION</th>
                            <th scope="col">COMPLETION</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% if relativeAccount%}
                                {% for account in relativeAccount %}
                                <tr>
                                    <td scope="row">{{ forloop.counter }}</td>
                                    <td><a href="{% url 'xadmin:user_detail' account.id %}">{{ account.username }}</td>
                                    <td>{{ account.source }}</td>
                                    <td>{{ account.channel }}</td>
                                    <td>{{ account.deposit }}</td>
                                    <td>{{ account.turnover }}</td>
                                    <td>{{ account.withdrawal }}</td>
                                    <td>{{ account.contribution }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                            {% endif %}
                            </tbody>
                        </thead>
                    </table>
                    <div class="row">
                        <div class='col-md-1'>
                            <button class="btn btn-primary"><span>Export</span></button>
                        </div>
                        <div class="transaction-control-group col-md-9"></div>
                        <div>
                            <div class='col-md-1'>
                            <!-- <div class='col-md-1'> -->
                                <input type="hidden" id="hidden_row" value="0"></input>
                                <select id="pagination_value"  class="form-control">
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="250">250</option>
                                </select>
                            </div>
                            <div class='col-md-1'>
                                <ul class="pagination" style="margin:0px;">
                                    <li class="page-item disabled" id='previousPage'>
                                    <a class="page-link" href="javascript:getPrevious();" tabindex="-1"><i class='fas fa-caret-left'></i></a>
                                    </li>
                                    {% if isLastPage is True %}
                                    <li class="page-item disabled" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% else %}
                                    <li class="page-item" id='nextPage'><a class="page-link" href="javascript:getNext();"><i class='fas fa-caret-right'></i></a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <!-- payment and member limitations section -->
    <div class="row" style="margin-top:20px; margin-left:3px;">
        <div class="payment-detail-rectangle col-md-5">  
            <div class="half-title-block" style="background-color: #4f7c1a;">
                <span class="detail-title">Payment</span>
                <div style="margin: 30px 15px 30px 15px;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="payment-block-title">PAYMENT PERMISSION LEVEL</div>
                            <div id="payment-block">
                                <div id="payment-text">Normal</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="payment-block-title">BANK ACCOUNT DETAILS</div>
                            <div class="col-md-6" style="padding-left:0px;">
                                <div class="payment-info">Bank name</div>
                                <div class="payment-info">Account number</div>
                                <div class="payment-info">Sort code</div>
                            </div>
                            <div class="col-md-6" style="padding-left:0px;">
                                <div class="payment-text">Bank name</div>
                                <div class="payment-text">Account number</div>
                                <div class="payment-text">Sort code</div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-left:0px;">
                        
                        <div class="payment-deposit">DEPOSIT METHODS</div>
                        <div class="col-md-3" style="padding:0px;">
                            <div class="label-text">METHOD</div>
                            <div class="deposit-table-first">
                                <div class="deposit-text">Bank card</div>
                            </div>
                            <div class="deposit-table-first" style="background-color: #ffffff">
                                <div class="deposit-text">Paypal</div>
                            </div>
                            <div class="deposit-table-first">
                                <div class="deposit-text">Netteller</div>
                            </div>
                            <div class="deposit-table-first" style="background-color: #ffffff">
                                <div class="deposit-text">Bank transfer</div>
                            </div>
                        </div>
                        <div class="col-md-3" style="padding:0px;">
                            <div class="label-text" style="margin-left:-20px">DETAILS</div>
                            <div class="deposit-table-second">
                                <div class="deposit-text">Bank card</div>
                            </div>
                            <div class="deposit-table-second" style="background-color: #ffffff">
                                <div class="deposit-text">Paypal</div>
                            </div>
                            <div class="deposit-table-second">
                                <div class="deposit-text">Netteller</div>
                            </div>
                            <div class="deposit-table-second" style="background-color: #ffffff">
                                <div class="deposit-text">Bank transfer</div>
                            </div>
                        </div>
                        <div class="col-md-3" style="padding:0px;">
                            <div class="label-text" style="margin-left:20%">TIMES USED</div>
                            <div class="deposit-table-third">
                                <div class="deposit-text">Bank card</div>
                            </div>
                            <div class="deposit-table-third" style="background-color: #ffffff">
                                <div class="deposit-text">Paypal</div>
                            </div>
                            <div class="deposit-table-third">
                                <div class="deposit-text">Netteller</div>
                            </div>
                            <div class="deposit-table-third" style="background-color: #ffffff">
                                <div class="deposit-text">Bank transfer</div>
                            </div>
                        </div>
                        <div class="col-md-3" style="padding:0px;">
                            <div class="label-text" style="margin-left:8%">BLOCKED</div>
                            <div class="deposit-table-forth">
                                <div class="deposit-text">Bank card</div>
                            </div>
                            <div class="deposit-table-forth" style="background-color: #ffffff">
                                <div class="deposit-text">Paypal</div>
                            </div>
                            <div class="deposit-table-forth">
                                <div class="deposit-text">Netteller</div>
                            </div>
                            <div class="deposit-table-forth" style="background-color: #ffffff">
                                <div class="deposit-text">Bank transfer</div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-left:0px;">
                        <button class="btn btn-primary set-permission-btn blockDisable">Set permissions</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="member-limitations-rectangle col-md-5">  
            <div class="half-title-block" style="background-color: #8b572a;">
                <span class="detail-title">Member limitations</span>
                <div style="margin: 30px 15px 30px 15px;">
                    <div class="row">
                        <div class="col-md-7">
                            <div style="min-height: 300px">
                                <div class="member-limitation-title">LIMITS</div>
                                    <!-- {% if limitation.bet %}
                                    {% for limit in limitation.bet %}
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="member-limit-info">Bet limit {{ forloop.counter }}</div>
                                            </div>
                                            <div class="col-md-8">
                                                <div class="member-limit-text">$ {{ limit.amount }} on {{ limit.product }}</div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                    {% else %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Bet limit</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$</div>
                                        </div>
                                    </div>
                                    {% endif %} -->
                                    {% if limitation.loss %}
                                    <!-- <div>{{ limitation.loss }}</div> -->
                                    {% for limit in limitation.loss %}
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="member-limit-info">Loss limit {{ forloop.counter }}</div>
                                            </div>
                                            <div class="col-md-8">
                                                <div class="member-limit-text">$ {{ limit.amount }} per {{ limit.interval }}</div>
                                            </div>
                                        </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Loss limit</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$</div>
                                        </div>
                                    </div>
                                {% endif %}
                                {% if limitation.deposit %}
                                    {% for limit in limitation.deposit %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Deposit limit {{ forloop.counter }}</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$ {{ limit.amount }} per {{ limit.interval }}</div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Deposit limit</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$</div>
                                        </div>
                                    </div>
                                {% endif %}
                                {% if limitation.withdraw %}
                                    {% for limit in limitation.withdraw %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Withdraw limit {{ forloop.counter }}</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$ {{ limit.amount }} per {{ limit.interval }}</div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="member-limit-info">Withdraw limit</div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="member-limit-text">$</div>
                                        </div>
                                    </div>
                                {% endif %}
                                <div style="margin:55px 0px 30px 0px;">
                                    <div class="row">
                                        <div class="member-limitation-title" style="margin-left:15px;">EXCLUSIONS</div>
                                        <div class="col-md-6">
                                            <div class="payment-info">Temporary time-out</div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="payment-text">{{ temperaryBlock.temporaryStr }}</div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="payment-info">Permanent time-out</div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="payment-text">{{ permanentBlock.permanentStr }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="set-limitation-btn btn btn-primary blockDisable" data-toggle="modal" data-target="#set_limitations">Set limitations</button>
                        </div>
                        <div class="col-md-5">
                            <div class="vl">
                                <div style="margin: 0px 15px;">
                                    <div class="member-limitation-title">PRODUCT ACCESS DENIED</div>
                                    {% for access in accessDenyObj %}
                                        <div id="deny-block"><div class="block-text" style="line-height: 43px; padding-left: 7px;">{{ access.product }}</div></div>
                                    {% endfor %}
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div>&nbsp;</div>
    <div class="row">
        <div class="col-md-11"></div>
        <div class="col-md-1">
            <a class="btn btn-primary" role="button" id="back-btn" href="{% url 'xadmin:user_list' %}">BACK</a>
        </div>
    </div>

    <div class="modal fade" id="set_limitations" role="dialog">
        <div class="modal-dialog">
        
        <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header" style="background-color: #8b572a; color:white;">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Edit member limitations</h4>
                    <div class="update-time">Updated {{ time }}</div>
                </div>
                <div class="modal-body">
                    <!-- <div style="padding:8%;"> -->
                    <form action="{% url 'xadmin:user_detail' %}" method="POST" id="limitForm">
                        <input type="hidden" name="type" value="limitation_setting"></input>
                        <input type="hidden" name="user_id" value="{{ customuser.pk }}"></input>
                        {% csrf_token %}
                        <!-- <div id="bet-container">
                            <input type="hidden" name="user_id" value="{{ customuser.pk }}"></input>
                            <input type="hidden" name="type" value="bet_limitation_setting"></input>
                            <input type="hidden" name="bet_option_id[]" id="bet_option_id" value="">
                            <div style="margin-bottom:2.5%"><label>BET LIMITS</label></div>
                            {% if limitation.bet %}
                                {% for limit in limitation.bet %}
                                <div class="row" style="margin-top:20px;">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">BET LIMITS</div>
                                        <input class="form-control" id="bet_limit[0]" name="bet_limit[]" value="{{ limit.amount }}">
                                    </div> -->
                                    <!-- <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">BET INTERVAL</div>
                                        <select class="form-control" id="bet_interval">
                                            <option value="bet">per bet</option>
                                            <option value="week">per week</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                        </select>
                                    </div> -->
                                    <!-- <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">PRODUCT</div>
                                        <select class="form-control" id="game_type[0]" name="game_type[]" value="{{ limit.productValue }}">
                                            <option value="0" {% if limit.productValue == 0 %} selected="selected"{% endif %}>GB Sports</option>
                                            <option value="1" {% if limit.productValue == 1 %} selected="selected"{% endif %}>EZ Sports</option>
                                            <option value="2" {% if limit.productValue == 2 %} selected="selected"{% endif %}>Games</option>
                                            <option value="3" {% if limit.productValue == 3 %} selected="selected"{% endif %}>Lotto</option>
                                            <option value="4" {% if limit.productValue == 4 %} selected="selected"{% endif %}>Live Casino</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-defaul delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                                {% endfor %} -->
                            <!-- {% else %}
                                <div class="row" style="margin-top:20px;">
                                        <div class="col-md-3 bet-limit-block">
                                            <div class="bet-limit-text">BET LIMITS</div>
                                            <input class="form-control" id="bet_limit[]" name="bet_limit[]" value="">
                                        </div> -->
                                        <!-- <div class="col-md-3 bet-limit-block">
                                            <div class="bet-limit-text">BET INTERVAL</div>
                                            <select class="form-control" id="bet_interval">
                                                <option value="bet">per bet</option>
                                                <option value="week">per week</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                            </select>
                                        </div> -->
                                        <!-- <div class="col-md-3 bet-limit-block">
                                            <div class="bet-limit-text">PRODUCT</div>
                                            <select class="form-control" id="game_type[]" name="game_type[]" value="">
                                                <option value="0">GB Sports</option>
                                                <option value="1">EZ Sports</option>
                                                <option value="2">Games</option>
                                                <option value="3">Lotto</option>
                                                <option value="4">Live Casino</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="bet-limit-text">&nbsp;</div>
                                            <button type="button" class="btn btn-defaul delete" style="background-color:rgb(199, 89, 82)">
                                                <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                            </button>
                                        </div>
                                    </div>
                            {% endif %} -->
                        <!-- </div>
                        <button class="add_bet_field btn btn-primary">Add New Field</button>
                            -->

                        <div id="loss-container">
                            <div style="margin-bottom:2.5%;"><label>LOSS LIMITS</label></div>
                            {% if limitation.loss %}
                                {% for loss in limitation.loss %}
                                <div class="row" style="margin-top:20px;">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">LOSS LIMIT</div>
                                        <input class="form-control" name="loss_limit" value="{{ loss.amount }}">
                                    </div>
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">LOSS LIMIT INTERVAL</div>
                                        <select class="form-control" name="loss_limit_interval">
                                            <option value="-1">select...</option>
                                            <option value="0" {% if loss.intervalValue == 0 %} selected="selected"{% endif %}>per day</option>
                                            <option value="1" {% if loss.intervalValue == 1 %} selected="selected"{% endif %}>per week</option>
                                            <option value="2" {% if loss.intervalValue == 2 %} selected="selected"{% endif %}>per month</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                            <div class="row">
                                <div class="col-md-3 bet-limit-block">
                                    <div class="bet-limit-text">LOSS LIMIT</div>
                                    <input class="form-control" name="loss_limit" value="">
                                </div>
                                <div class="col-md-3 bet-limit-block">
                                    <div class="bet-limit-text">LOSS LIMIT INTERVAL</div>
                                    <select class="form-control" name="loss_limit_interval">
                                        <option value="-1">select...</option>
                                        <option value="0">per day</option>
                                        <option value="1">per week</option>
                                        <option value="2">per month</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <div class="bet-limit-text">&nbsp;</div>
                                    <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                        <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                    </button>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        <button class="add_loss_field btn btn-primary">Add New Field</button>


                        <div id="deposit-container">
                            <div style="margin-bottom:2.5%; margin-top:6%;"><label>DEPOSIT LIMITS</label></div>
                            {% if limitation.deposit %}
                                {% for deposit in limitation.deposit %}
                                <div class="row" style="margin-top:20px;">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">DEPOSIT LIMIT</div>
                                        <input class="form-control" id="deposit_limit" name="deposit_limit" value="{{ deposit.amount }}">
                                    </div>
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">DEPOSIT INTERVAL</div>
                                        <select class="form-control" id="deposit_limit_interval" name="deposit_limit_interval">
                                            <option value="-1">select...</option>
                                            <option value="0" {% if deposit.intervalValue == 0 %} selected="selected"{% endif %}>per day</option>
                                            <option value="1" {% if deposit.intervalValue == 1 %} selected="selected"{% endif %}>per week</option>
                                            <option value="2" {% if deposit.intervalValue == 2 %} selected="selected"{% endif %}>per month</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="row">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">DEPOSIT LIMIT</div>
                                        <input class="form-control" id="deposit_limit" name="deposit_limit" value="">
                                    </div>
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">DEPOSIT INTERVAL</div>
                                        <select class="form-control" id="deposit_limit_interval" name="deposit_limit_interval">
                                            <option value="-1">select...</option>
                                            <option value="0">per day</option>
                                            <option value="1">per week</option>
                                            <option value="2">per month</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <button class="add_deposit_field btn btn-primary">Add New Field</button>


                        <div id="withdraw-container">
                            <div style="margin-bottom:2.5%; margin-top:6%;"><label>WITHDRAW LIMITS</label></div>
                            {% if limitation.withdraw %}
                                {% for withdraw in limitation.withdraw %}
                                <div class="row" style="margin-top:20px;">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">WITHDRAW LIMIT</div>
                                        <input class="form-control" id="withdraw_limit" name="withdraw_limit" value="{{ withdraw.amount }}">
                                    </div>
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">WITHDRAW INTERVAL</div>
                                        <select class="form-control" id="withdraw_interval" name="withdraw_limit_interval">
                                            <option value="-1">select...</option>
                                            <option value="0" {% if withdraw.intervalValue == 0 %} selected="selected"{% endif %}>per day</option>
                                            <option value="1" {% if withdraw.intervalValue == 1 %} selected="selected"{% endif %}>per week</option>
                                            <option value="2" {% if withdraw.intervalValue == 2 %} selected="selected"{% endif %}>per month</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="row">
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">WITHDRAW LIMIT</div>
                                        <input class="form-control" id="withdraw_limit" name="withdraw_limit" value="{{ withdraw.amount }}">
                                    </div>
                                    <div class="col-md-3 bet-limit-block">
                                        <div class="bet-limit-text">WITHDRAW INTERVAL</div>
                                        <select class="form-control" id="withdraw_interval" name="withdraw_limit_interval">
                                            <option value="-1">select...</option>
                                            <option value="0">per day</option>
                                            <option value="1">per week</option>
                                            <option value="2">per month</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bet-limit-text">&nbsp;</div>
                                        <button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)">
                                            <span class="glyphicon glyphicon-trash" style='color:white'></span>
                                        </button>
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                        <button class="add_withdraw_field btn btn-primary">Add New Field</button>
                        
                        <div>
                            <div style="margin-bottom:2.5%; margin-top:6%;"><label>PRODUCT ACCESS DENIED</label></div>
                            <input type="text" id="tag1" class="form-control" />
                            <input type="hidden" id="hidden_tags" name="access_deny_tags" value="[]"></input>
                        </div>
                        <div>
                            <div style="margin-bottom:2.5%; margin-top:6%;"><label>EXCLUSTIONS</label></div>
                            <div class="row">
                                <div class="col-md-5">
                                    <div class="bet-limit-text">TEMPORARY TIME-OUT</div>
                                    <select class="form-control" name="temporary_time">
                                        <option value="-1">select...</option>
                                        <option value="0">per day</option>
                                        <option value="1">per week</option>
                                        <option value="2">per month</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-5">
                                    <div class="bet-limit-text">PERMANENT TIME-OUT</div>
                                    <select class="form-control" name="permanent_time">
                                        <option value="-1">select...</option>
                                        <option value="3">6 months</option>
                                        <option value="4">1 year</option>
                                        <option value="5">3 years</option>
                                        <option value="6">5 years</option>
                                    </select>
                                </div>
                            </div>
                            <!-- <div class="row" style="margin-top:20px;">
                                <div class="col-md-5">
                                    <div class="bet-limit-text">SELF-EXCLUSTION</div>
                                    <input class="form-control" id="self-exculstion" value="" readonly/>
                                </div>
                            </div> -->
                        </div>
                        <div style="margin-top: 20px;">
                            <div class="form-group">
                                <div class="bet-limit-text">REASON FOR CHANGES</div>
                                <textarea class="form-control" id="reasonTextarea" name="reasonTextarea" rows="3" placeholder="Please provide a brief explanation."></textarea>
                            </div>
                        </div>
                        <button type="submit" id="limit_submitButton" class="btn btn-primary" style="margin-top: 20px; width:13%;">Save</button>
                        <button type="button" id="cancel" class="btn btn-primary" data-dismiss="modal" style="margin-top: 20px;">Cancel</button>
                    </form>
                    <!-- </div> -->
                </div>
                <!-- <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div> -->
            </div> 
        </div>
    </div>
        
    <!-- </div> -->

<!-- <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.css" rel="stylesheet"/> -->
<script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<!-- <link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/css/bootstrap-datetimepicker.css" rel="stylesheet"/> -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/css/datepicker.css" rel="stylesheet" type="text/css" />
<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/js/bootstrap-datepicker.js"></script>
<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.7.14/js/bootstrap-datetimepicker.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-tagsinput/0.8.0/bootstrap-tagsinput.css" crossorigin="anonymous"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/corejs-typeahead/1.2.1/typeahead.bundle.js"></script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css" />
<script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>

<script>

// $('#datetimepicker1').datetimepicker();


function viewBetInfo(bet_id){
    $('#trans_bet_placed_detail').modal({'show' : true});
    // bet_history_detail

    $.ajax({
        type: "GET",
        url: "{% url 'get_bet_history_info' %}",
        data:{ 
            'bet_id': bet_id,
        },
        success: function(response)
        {

            // console.log(response.outcome);
            $("#bet_history_detail").empty();
            var content = "";
            content += "<p>" + response.user + "</p>";
            content += "<p>" + response.bet_id + "</p>";
            content += "<p>" + response.bet_time + "</p>";
            content += "<p>" + response.amount_won + "</p>";
            content += "<p>" + response.amount_wagered + "</p>";
            content += "<p>" + response.resolved_time + "</p>";
            content += "<p>" + response.outcome + "</p>";
            content += "<p>" + response.status + "</p>";
            // content += "<p><span>" + getField(trans, 'channel') + "</span>&nbsp;/&nbsp;<span>" + getField(trans, 'method') + "</span></p>";
            // content += "<p>/</p>";
            // content += "<p>/</p>";
            // content += "<p>/</p>";
            // content += "<p>" + getField(trans, 'channel') + "</p>";
            // content += "<p>" + getField(trans, 'amount') + "</p>";
            // content += "<p>" + getField(trans, 'amount') + "</p>";
            // content += "<p>fee</p>"
            // content += "<p>/</p>";
            // content += "<p>/</p>";
            // content += "<p>/</p>";
            // content += "<p>" + getField(trans, 'status') + "</p>";
            $("#bet_history_detail").append(content);
        }
    });
    
}

$(document).ready(function() {
    var csrftoken = $.cookie("csrftoken");
    // console.log(csrftoken);

    var imgUrl = $('#user-photo-img').prop('src');
    $('#hidden_user_id_url').attr('value', imgUrl);

    var previousURL = document.referrer;

    $("#back-btn").attr("href", previousURL);

    var user_id = $('#hidden_user_id').val();
    getWalletAmount(user_id);
    getProductAmount(user_id);

    function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    chooseFile = function (event) {
        // $("#fileInput").click();
        // let val = $("#fileInput").val();
        // console.log(val);
        // $('image').attr(src) = val;
        var input = event.target;
        // $('#user-photo-img').css('display', 'none');

        var reader = new FileReader();
        reader.onload = function(){
            var dataURL = reader.result;
            var output = document.getElementById('user-photo-img');
            output.src = dataURL;
            $('#hidden_user_id_url').attr('value', dataURL);
            $('input[name="user_id_img_first"]').attr('value', true);
        };
        reader.readAsDataURL(input.files[0]);
        
        $('#user-photo-img').css('max-width', '250px');
        $('#user-photo-img').css('max-height', '200px');
   }

   clickUploadImg = function () {
        $('#hidden_input_img').click();
   }

   clearImg = function() {
        $('#user-photo-img').attr('src', 'https://www.imagemet.com/wp-content/uploads/2016/12/placeholder.png');
        $('#hidden_user_id_url').attr('value', '');
        $('input[name="user_id_img_first"]').attr('value', false);
   }

    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken);
            }
        }
    });

    var block =  "{{ customuser.block }}";
    if (block == "True") {
        $(".blockDisable").prop("disabled", "disabled");
    }

    $("#member_id").prop("readonly", true);
    $("#username").prop("readonly", true);

    $('#username').blur(function() {                   
        if( !$(this).val().trim() ) {    
            $('#errorMessage').text('Username cannot be empty'); 
            $('#errorMessage').css('color', 'red'); 
            $('#username').focus();
            $('#submitButton').attr('disabled', 'disabled');
        } else {
            $('#submitButton').removeAttr('disabled');
            $('#errorMessage').text(''); 
        }
        
    });

    $('#email').blur(function() {                   
        if( !$(this).val().trim() ) {    
            $('#errorMessage').text('Email cannot be empty'); 
            $('#errorMessage').css('color', 'red'); 
            // $('#email').focus();
            $('#submitButton').attr('disabled', 'disabled');
        } else {
            $('#submitButton').removeAttr('disabled');
            $('#errorMessage').text('');
        }
        
    });

    $('#phone').blur(function() {                   
        if( !$(this).val().trim() ) {    
            $('#errorMessage').text('Phone cannot be empty'); 
            $('#errorMessage').css('color', 'red'); 
            // $('#phone').focus();
            $('#submitButton').attr('disabled', 'disabled');
        } else {
            $('#submitButton').removeAttr('disabled');
            $('#errorMessage').text('');
        }
    });

    $('#zoom-btn').on('click', function () {
        var image = $('#user-photo-id').attr('src');
        $('#myModal').on('show.bs.modal', function () {
            $(".showimage").attr("src", image);
        });
    });

    $(function () {
        $('#transaction_time_from').datepicker({ 
        autoclose: true, 
        todayHighlight: true,
        endDate: new Date()
        }).val('');
        $('#transaction_time_to').datepicker({ 
        autoclose: true, 
        todayHighlight: true,
        endDate: new Date()
        }).val('');
    });
    
    // var user_id = $('#hidden_user_id').val();
    // console.log(user_id)

    $('#transaction_time_submit').click( function(e) {
        e.preventDefault();

        $('#hidden_row').val(0);
        getTransactions(0);
    });

    $('#transaction_product_select').change(function() { 
        $('#hidden_row').val(0);
        getTransactions(0);
    });

    $('#transaction_category_select').change(function() { 
        $('#hidden_row').val(0);
        getTransactions(0);
    });

    $('#pagination_value').on('change', function() {
        $('#hidden_row').val(0);
        getTransactions(0);
    });

    var risk_level = $("#risk_level_input").val();
    $("#risk_level_select").val(risk_level).change();

    $('#post-btn').click( function(e) {
        e.preventDefault();
        var message = $('#notes-input').val();
        if (!message) {
            alert("Input cannot be empty");
            return;
        }
        updateNote(message);
    });


    $('#activity-select').change(function() {
        var activity = $('#activity-select').val();
        getActivityfilter(activity);
    });

    var limit_options = ["bet_limit"];
    $('#bet_option_id').val(limit_options); 

    $('.add_bet_field').click(function(e){
        e.preventDefault();
        var x = $('#bet-container').find('button').length;
        var content = '<div class="row" style="margin-top:20px;"><div class="col-md-3 bet-limit-block"><div class="bet-limit-text">BET LIMITS</div><input class="form-control" id="bet_limit[]" name="bet_limit[]" value=""></div>';
        // content += '<div class="col-md-3 bet-limit-block"><div class="bet-limit-text">BET INTERVAL</div><select class="form-control" id="bet_interval_' + x + '"><option value="bet">per bet</option> <option value="week">per week</option><option value="2">2</option> <option value="3">3</option></select></div>';
        content += '<div class="col-md-3 bet-limit-block"><div class="bet-limit-text">PRODUCT</div><select class="form-control" id="game_type[]" name="game_type[]"><option value="0">GB Sports</option><option value="1">EZ Sports</option><option value="2">Games</option><option value="3">Lotto</option><option value="4">Live Casino</option></select></div>';
        content += '<div class="col-md-2"><div class="bet-limit-text">&nbsp;</div><button type="button" class="btn btn-default delete limit-delete" style="background-color:rgb(199, 89, 82)"><span class="glyphicon glyphicon-trash" style="color:white"></span> </button></div></div>';
        $("#bet-container").append(content);

        var bet_limit = "#bet_limit_" + x;
        var temp = $("#bet_option_id").val();
        x++;
    });

    $("#bet-container").on("click",".delete", function(e){
        e.preventDefault(); 
        var target = $( e.target );
        if ( target.is( 'span' ) ) {
            var row = e.target.parentElement.parentElement.parentElement;
            var input = row.getElementsByTagName("input")[0];
            // console.log(input.getAttribute("id"));
        } else {
            var row = e.target.parentElement.parentElement;
            // console.log(row);
        }
        row = $(row);
        row.remove();
    });

    $('.add_loss_field').click(function(e){
        e.preventDefault();
        var x = $('#loss-container').find('button').length;
        var content = '<div class="row" style="margin-top:20px;"><div class="col-md-3 bet-limit-block"><div class="bet-limit-text">LOSS LIMIT</div><input class="form-control" name="loss_limit" value=""></div>';
        content += '<div class="col-md-3 bet-limit-block"><div class="bet-limit-text">LOSS LIMIT INTERVAL</div><select class="form-control" name="loss_limit_interval"><option value="-1">select...</option><option value="0">per day</option><option value="1">per week</option><option value="2">per month</option></select></div>';
        content += '<div class="col-md-2"><div class="bet-limit-text">&nbsp;</div><button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)"><span class="glyphicon glyphicon-trash" style="color:white"></span> </button></div></div>';
        $("#loss-container").append(content);
        x++;

    });

    $("#loss-container").on("click",".delete", function(e){
        e.preventDefault(); 
        var target = $( e.target );
        if ( target.is( 'span' ) ) {
            var row = e.target.parentElement.parentElement.parentElement;
        } else {
            var row = e.target.parentElement.parentElement;
        }
        row = $(row);
        row.remove();
    });

    $('.add_deposit_field').click(function(e){
        e.preventDefault();
        var x = $('#deposit-container').find('button').length;
        var content = '<div class="row" style="margin-top:20px;"><div class="col-md-3 bet-limit-block"><div class="bet-limit-text">DEPOSIT LIMIT</div><input class="form-control" name="deposit_limit" value=""></div>';
        content += '<div class="col-md-3 bet-limit-block"><div class="bet-limit-text">DEPOSIT INTERVAL</div><select class="form-control" name="deposit_limit_interval"><option value="-1">select...</option><option value="0">per day</option><option value="1">per week</option><option value="2">per month</option></select></div>';
        content += '<div class="col-md-2"><div class="bet-limit-text">&nbsp;</div><button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)"><span class="glyphicon glyphicon-trash" style="color:white"></span> </button></div></div>';
        $("#deposit-container").append(content);
        x++;

    });

    $("#deposit-container").on("click",".delete", function(e){
        e.preventDefault(); 
        var target = $( e.target );
        if ( target.is( 'span' ) ) {
            var row = e.target.parentElement.parentElement.parentElement;
        } else {
            var row = e.target.parentElement.parentElement;
        }
        row = $(row);
        row.remove();
    });

    $('.add_withdraw_field').click(function(e){
        e.preventDefault();
        var x = $('#withdraw-container').find('button').length;
        var content = '<div class="row" style="margin-top:20px;"><div class="col-md-3 bet-limit-block"><div class="bet-limit-text">WITHDRAW LIMIT</div><input class="form-control" name="withdraw_limit" value=""></div>';
        content += '<div class="col-md-3 bet-limit-block"><div class="bet-limit-text">WITHDRAW INTERVAL</div><select class="form-control" name="withdraw_limit_interval"><option value="-1">select...</option><option value="0">per day</option><option value="1">per week</option><option value="2">per month</option></select></div>';
        content += '<div class="col-md-2"><div class="bet-limit-text">&nbsp;</div><button type="button" class="btn btn-default delete" style="background-color:rgb(199, 89, 82)"><span class="glyphicon glyphicon-trash" style="color:white"></span> </button></div></div>';
        $("#withdraw-container").append(content);
        x++;

    });

    $("#withdraw-container").on("click",".delete", function(e){
        e.preventDefault(); 
        var target = $( e.target );
        if ( target.is( 'span' ) ) {
            var row = e.target.parentElement.parentElement.parentElement;
        } else {
            var row = e.target.parentElement.parentElement;
        }
        row = $(row);
        row.remove();
    });

    getNext = function() {
        if ($('#nextPage').hasClass('disabled')) {
            return;
        }
        var pageSize = $("#pagination_value").val();
        var oldFromItem = $('#hidden_row').val();
        var newFromItem = Number(oldFromItem) + Number(pageSize);
        $('#hidden_row').val(newFromItem);
        getTransactions(newFromItem);
       
    }

    getPrevious = function () {
        if ($('#previousPage').hasClass('disabled')) {
            return;
        }
        var pageSize = $('#pagination_value').val();
        var oldFromItem = $('#hidden_row').val();
        var newFromItem = Number(oldFromItem) - Number(pageSize);
        $('#hidden_row').val(newFromItem);
        getTransactions(newFromItem);
    }

    getBetNext = function() {
        if ($('#nextBetPage').hasClass('disabled')) {
            return;
        }
        var pageSize = $("#bet_pagination_value").val();
        var oldFromItem = $('#bet_hidden_row').val();
        var newFromItem = Number(oldFromItem) + Number(pageSize);
        $('#bet_hidden_row').val(newFromItem);
        getBetHistroy(newFromItem);
       
    }

    getBetPrevious = function () {
        if ($('#previousBetPage').hasClass('disabled')) {
            return;
        }

        var pageSize = $('#bet_pagination_value').val();
        var oldFromItem = $('#bet_hidden_row').val();
        var newFromItem = Number(oldFromItem) - Number(pageSize);
        $('#bet_hidden_row').val(newFromItem);
        // console.log(newFromItem);
        getBetHistroy(newFromItem);
    }

    $('#bet_product_select').change(function() { 
        $('#bet_hidden_row').val(0);
        getBetHistroy(0);
    });

    $('#bet_time_submit').click( function(e) {
        e.preventDefault();
        $('#bet_hidden_row').val(0);
        getBetHistroy(0);
    });

    $('#bet_pagination_value').on('change', function() {
        $('#bet_hidden_row').val(0);
        getBetHistroy(0);
    });


    $(function () {
        $('#bet_time_from').datepicker({ 
        autoclose: true, 
        todayHighlight: true,
        endDate: new Date()
        }).val('');
        $('#bet_time_to').datepicker({ 
        autoclose: true, 
        todayHighlight: true,
        endDate: new Date()
        }).val('');
    });

    showInitialTransaction = function (username, trans, type) {
        trans = JSON.parse(trans.replace(/'/g, '"'));
        showTransaction(username, trans, type);
    }

    showTransaction = function (username, trans, type) {
        // var trans = JSON.parse(trans.replace(/'/g, '"'));
        // console.log(JSON.parse(trans));
        var time = 'N/A';
        if (trans.time) {
            var time = moment(trans.time).format('MMMM, D, YYYY h:mm a');
        } 
        
        if (type === "deposit") {
            $("#deposit-detail").empty();
            var content = "";
            content += "<p>" + username + "</p>";
            content += "<p>" + getField(trans, 'transactionId') + "</p>";
            content += "<p>" + time + "</p>";
            content += "<p>" + time + "</p>";
            content += "<p>/</p>";
            content += "<p><span>" + getField(trans, 'channel') + "</span>&nbsp;/&nbsp;<span>" + getField(trans, 'method') + "</span></p>";
            content += "<p>/</p>";
            content += "<p>" + getField(trans, 'amount') + "</p>";
            content += "<p>" + getField(trans, 'amount') + "</p>";
            content += "<p>" + getField(trans, 'status') + "</p>";
            $("#deposit-detail").append(content);

        } else if (type == "withdraw") {
            $("#withdraw-detail").empty();
            var content = "";
            content += "<p>" + username + "</p>";
            content += "<p>" + getField(trans, 'transactionId') + "</p>";
            content += "<p>" + time + "</p>";
            content += "<p>" + time + "</p>";
            content += "<p><span>" + getField(trans, 'channel') + "</span>&nbsp;/&nbsp;<span>" + getField(trans, 'method') + "</span></p>";
            content += "<p>/</p>";
            content += "<p>/</p>";
            content += "<p>/</p>";
            content += "<p>" + getField(trans, 'channel') + "</p>";
            content += "<p>" + getField(trans, 'amount') + "</p>";
            content += "<p>" + getField(trans, 'amount') + "</p>";
            content += "<p>fee</p>"
            content += "<p>/</p>";
            content += "<p>/</p>";
            content += "<p>/</p>";
            content += "<p>" + getField(trans, 'status') + "</p>";
            $("#withdraw-detail").append(content);
        }
    }

    getField = function(object, field) {
        if (object[field]) {
            return object[field];
        } 
        return 'N/A';
    }

    var ctx = document.getElementById('deposit-withdraw-chart');
    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'bar',

        // The data for our dataset
        data: {
            labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
            datasets: [{
                label: 'My First dataset',
                backgroundColor: 'rgb(255, 99, 132)',
                borderColor: 'rgb(255, 99, 132)',
                data: [0, 10, 5, 2, 20, 30, 45]
            }]
        },
        // Configuration options go here
        options: {}
    });


    var data = '[{ "value": 0, "text": "GB SPORTS", "continent": "PRODUCT" }, { "value": 1, "text": "EZ SPORTS", "continent": "PRODUCT" }, { "value": 2, "text": "GAMES", "continent": "PRODUCT" }, { "value": 3, "text": "LOTTO", "continent": "PRODUCT" }, { "value": 4, "text": "LIVE CASINO", "continent": "PRODUCT" }]';

    //get data pass to json
    var task = new Bloodhound({
        datumTokenizer: Bloodhound.tokenizers.obj.whitespace("text"),
        queryTokenizer: Bloodhound.tokenizers.whitespace,
        local: jQuery.parseJSON(data) //your can use json type
    });

    task.initialize();

    var elt = $("#tag1");
    elt.tagsinput({
        allowDuplicates: false,
        itemValue: "value",
        itemText: "text",
        typeaheadjs: {
            name: "task",
            displayKey: "text",
            source: task.ttAdapter()
        }
    });

    var accessDeny = '{{ productAccess|safe }}';
    if (accessDeny) {

        accessDeny = JSON.parse(accessDeny);
        var tagsArray = $('#hidden_tags').val();
        // console.log("tagsArray: " + tagsArray);
        tagsArray = JSON.parse(tagsArray);
    
        for (var i = 0; i < accessDeny.length; i++) {
            elt.tagsinput('add', { "value": accessDeny[i].productValue , "text": accessDeny[i].product , "continent": "PRODUCT" });
            tagsArray.push(accessDeny[i].productValue);
        }
        $('#hidden_tags').val(JSON.stringify(tagsArray));
    }
    
    
    $('#tag1').on('beforeItemAdd', function(event) {
        // console.log(event.item.text);
        var tags = $('#hidden_tags').val();
        tags = JSON.parse(tags);
        tags.push(event.item.value);

        $('#hidden_tags').val(JSON.stringify(tags));
    });


    $('#tag1').on('itemRemoved', function(event) {
        var tags = $('#hidden_tags').val();
        tags = JSON.parse(tags);
        array = removeByIndex(tags, event.item.value);
        $('#hidden_tags').val(JSON.stringify(array));
        // console.log($('#hidden_tags').val());
    });

    $('#close-account-btn').on('click', function () {
        $('#close-account-btn').html('Click to Close account');
        $('#close-account-btn').attr('id', 'close-account');
        $('#close-account').attr('onclick', 'userBlockAction("block")');
    });

    $('#limitForm').on('submit', function(e) {
        // e.preventDefault();
        // var form = $(this);
        // var url = form.attr('action');
        // var data = form.serialize();
        // console.log(data);
        // console.log(url);
        var regex = /[0-9]|\./;
        // $(this).find('input[name="loss_limit"]').each(function() {
        //     if (!regex.test(this.value)) {
        //         this.focus();             
        //         alert("format not correct for this field");
        //         e.preventDefault();      
        //         return false;
        //     }
        // });
        var lossValue = $("input[name=loss_limit]").val();
        var depositValue = $("input[name=deposit_limit]").val();
        var withdrawValue = $("input[name=withdraw_limit]").val();

        if ( lossValue && !regex.test(lossValue) || depositValue && !regex.test(depositValue) || withdrawValue && !regex.test(withdrawValue)) {
            alert("format not correct for this field");
            e.preventDefault();      
            return false;
        }
    });


    $("input[name='debit-credit']").change(function() {
        // console.log($(this).val());
        var value = $(this).val();
        if (value == 'credit') {
            $("#wagering_amount_div").css('display', 'block');
        } else {
            $("#wagering_amount_div").css('display', 'none');
        }
    });

    $("input[name='transfer-notify-player']").change(function() {
        if ($('input[name="transfer-notify-player"]').is(":checked")) {
            $("#transfer-message-player").css('display', 'block');
        } else {
            $("#transfer-message-player").css('display', 'none');
        }
    });


    $("input[name='adjust-notify-player']").change(function() {
        if ($('input[name="adjust-notify-player"]').is(":checked")) {
            $("#message-player").css('display', 'block');
        } else {
            $("#message-player").css('display', 'none');
        }
    });


    $('#wagering_amount').mouseleave(function() {
        var amount = parseInt($('#adjust_amount').val());
        var wagering_amount = parseInt($('#wagering_amount').val());
        var sum = amount * wagering_amount;
        var text = "* " + amount + " = " + sum;
        $('.input-group-addon').text(text);
    })

    var arrBefore = $("#edit-member-form").serializeArray();
    // console.log(arrBefore);
    $("#edit-member-form").submit(function(e) {

        e.preventDefault(); // avoid to execute the actual submit of the form.
        var form = $(this);
        var reason_input = $("textarea[name='reason_text']").val();
        if (!reason_input) {
            alert("please give the reason for changing request");
            return;
        }
        var url = "{% url 'xadmin:user_detail' %}";
        var arrAfter = form.serializeArray();
        var update_fields = checkDiff(arrBefore, arrAfter);
        // console.log(update_fields);
        var data = form.serialize() + "&update_fields=" + JSON.stringify(update_fields);
        // // console.log(data);
        $.ajax({
            type: "POST",
            url: url,
            data: data,
            success: function(data)
            {
                // console.log(data);
                window.location.reload();
            }
        });
    });
});

function checkDiff(before, after) {
    var whatsChanged = [];

    for (i = 0; i < before.length; i++) {
        if (after[i].name == 'user_id_img' || before[i].name == 'user_id_img') {
            continue;
        } else if (after[i].value !== before[i].value) {
            whatsChanged.push(after[i]);
        }
    }
    return whatsChanged;
}


function limitFormValid(value) {
    var isValid = true;
    var regex = /[0-9]|\./;
    $('#limitForm input').each(function() {
        if( !regex.test(value) ) {
            isValid = false;
        }
    });
    return isValid;
}

function removeByIndex(array, index){
    return array.filter(function(elem, _index){
        return index != elem;
    });
}

function userBlockAction(actionType) {
    var user_id = $('#hidden_user_id').val();
    var admin = "{{ user.username }}";
    // console.log(actionType);
    $.ajax({
        type:'POST',
        url:"{% url 'xadmin:user_detail' %}",
        data:{ 
            'type': 'block_user',
            'user_id': user_id,
            'action': actionType,
            'admin_user': admin,
        },
        success:function(data) {
            if (data.errorCode == "1001") {
                $('#errorMessage').text(data.message); 
                $('#errorMessage').css('color', 'red'); 
            } else {
                location.reload();
            }
            
            // $('#set_limitations').show();
            // $("#myModal .modal-body").load(target, function() { 
            //     $("#set_limitations").modal("show"); 
            // });
            // $("#set_limitations").modal("show"); 
            // $('#set_limitations').modal({'backdrop': 'static'});
        }
    });
}

function updateNote(message) {

    var user_id = $('#hidden_user_id').val();
    var admin_user = "{{ user.username }}";
    $.ajax({
        type:'POST',
        url:"{% url 'xadmin:user_detail' %}",
        data:{ 
            'type': 'update_message',
            'user_id': user_id,
            'admin_user': admin_user,
            'message': message,
        },
        success:function(data) {
            location.reload();
        }
    });
}

function getActivityfilter(activity) {

    var user_id = $('#hidden_user_id').val();
    $.ajax({
        type:'POST',
        url:"{% url 'xadmin:user_detail' %}",
        data:{ 
            'type': 'activity_filter',
            'user_id': user_id,
            'activity_type': activity
        },
        success:function(data) {
            // console.log(data);
            getActivityData(data);
        }
    });
    

}

function getActivityData(data) {

    $("#select-filter").empty();
    content = "";
    for(var i = 0; i < data.length; i++) {
        content += '<div class="note-author">' + data[i].adminUser + '</div>';
        content += '<div class="note-block">' + data[i].message + '</div>';
    }
    $("#select-filter").append(content);
}


function getBetHistroy(fromItem) {
    var user_id = $('#hidden_user_id').val();

    var time_from = $('#bet_time_from_input').val();
    // time_from = moment(time_from).format('YYYY-MM-DD HH:mm');
    // time_from = time_from.format('YYYY-MM-DD HH:mm');
    var time_to = $('#bet_time_to_input').val();
    // time_to = moment(time_to).format('YYYY-MM-DD HH:mm');

    var category = $('#bet_category_select').val();
    var product = $('#bet_product_select').val();

    var pageSize = $("#bet_pagination_value").val();

    $.ajax({
        type:'GET',
        url:"{% url 'get_user_transactions' %}",
        data:{ 
            'type': 'bet_history',
            'user_id': user_id,
            'from': time_from,
            'to': time_to,
            'fromItem': fromItem,
            'pageSize': pageSize,
            'category': category,
            'product': product
        },
        success:function(data) {

            // console.log(data);
            getBetData(data);
        }
    });

}

function getTransactions(fromItem) {

    var user_id = $('#hidden_user_id').val();

    var time_from = $('#transaction_time_from_input').val();
    // time_from = moment(time_from).format('YYYY-MM-DD HH:mm');
    // time_from = time_from.format('YYYY-MM-DD HH:mm');
    var time_to = $('#transaction_time_to_input').val();
    // time_to = moment(time_to).format('YYYY-MM-DD HH:mm');

    var category = $('#transaction_category_select').val();
    var product = $('#transaction_product_select').val();

    var pageSize = $("#pagination_value").val();

    $.ajax({
        type:'GET',
        url:"{% url 'get_user_transactions' %}",
        data:{ 
            'type': 'transaction',
            'user_id': user_id,
            'from': time_from,
            'to': time_to,
            'fromItem': fromItem,
            'pageSize': pageSize,
            'category': category,
            'product': product
        },
        success:function(data) {

            getTransData(data);
        }
    });
}


function getBetData(data) {
    if (data['isLastPage']) {
        $('#nextBetPage').addClass('disabled');
    } else {
        $('#nextBetPage').removeClass('disabled');
    }
    if (data['isFirstPage']) {
        $('#previousBetPage').addClass('disabled');
    } else {
        $('#previousBetPage').removeClass('disabled');
    }
    var data = data['transactions'];
    $("#bet_history_tbody").empty();
    for (var i = 0; i < data.length; i++) {
        var content = '';
        content += '<tr>';
        content += '<td>' + data[i].category + '</td>';
        content += '<td>' + data[i].product + '</td>';
        content += '<td>' + data[i].transactionId + '</td>';
        content += '<td>' + data[i].amount_wagered + '</td>';
        content += '<td>' + data[i].amount_won + '</td>';
        content += '<td>' + data[i].currency + '</td>';
        content += '<td>' + data[i].bet_time + '</td>';
        content += '<td>' + data[i].status + '</td>';
        content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_placed_detail" onclick="viewBetInfo(' + data[i].pk + ')" ><span class="glyphicon glyphicon-search"></span></button></td>';
        content += '</tr>';
        $("#bet_history_tbody").append(content);
    }
    
}

function getTransData(data) {

    if (data['isLastPage']) {
        $('#nextPage').addClass('disabled');
    } else {
        $('#nextPage').removeClass('disabled');
    }
    if (data['isFirstPage']) {
        $('#previousPage').addClass('disabled');
    } else {
        $('#previousPage').removeClass('disabled');
    }
    var data = data['transactions'];
    $("#transaction_tbody").empty();
    for (var i = 0; i < data.length; i++) {
        var content = '';
        content += '<tr>';
        content +=  '<td>' + data[i].category + '</td>';
        content +=  '<td>' + data[i].product + '</td>';
        content +=  '<td>' + data[i].transactionId + '</td>';
        content +=  '<td>' + data[i].fromWallet + '</td>';
        content +=  '<td>' + data[i].toWallet + '</td>';
        content +=  '<td>' + data[i].currency + '</td>';
        content +=  '<td>' + data[i].time + '</td>';
        content +=  '<td>' + data[i].amount + '</td>';
        content +=  '<td>' + data[i].balance + '</td>';
        content +=  '<td>' + data[i].status + '</td>';

        trans = ''
        if (data[i].transTypeCode == 0) {
                content += '<td><button type="button" onclick=\'showTransaction(\"{{ customuser.username }}\", ' + trans + ', \"deposit\")\' class="btn btn-primary" data-toggle="modal" data-target="#trans_deposit_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 1) {
                content += '<td><button type="button" onclick=\'showTransaction(\"{{ customuser.username }}\", ' + trans + ', \"withdraw\")\' class="btn btn-primary" data-toggle="modal" data-target="#trans_withdrawal_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 2) { 
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_placed_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 3) {
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bet_settled_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 4) {
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_trans_in_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 5) {
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_trans_out_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 6) {
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_bonus_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } else if (data[i].transTypeCode == 7) {
                content += '<td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#trans_adjustment_detail"><span class="glyphicon glyphicon-search"></span></button></td>';
            } 
        content += '</tr>';
        $("#transaction_tbody").append(content);
    }
}


function getWalletAmount(user_id) {

    // setTimeout(showPage, 6000);
    $.ajax({
        type:'GET',
        url:"{% url 'get_each_wallet_amount' %}",
        data:{ 
            'user_id': user_id,
        },
        success:function(data) {
            // console.log(data);
            $('.loader').css('display', 'none');
            $('#eachWallet').css('display', 'block');
            renderChart(data);
        },
        error: function() {
            showPage();
        }
    });

}

function showPage() {
    $('#chart5').text("There is something wrong");
    $('#chart5').css('width', '300px');
    $('.loader').css('display', 'none');
    $('#eachWallet').css('display', 'block');
}


function renderChart(data) {

    let total = 0;
    var walletMap = {
        "mainValue": 0,
        "oneBookValue": 0,
        "PTValue": 0,
        "AGValue": 0,
        "KYValue": 0,
        "GPIValue": 0,
        "EAValue": 0,
        "OPUSValue": 0,
        "BBINValue": 0,
    }

    var amountMap = {
        "mainValue": 0,
        "oneBookValue": 0,
        "PTValue": 0,
        "AGValue": 0,
        "KYValue": 0,
        "GPIValue": 0,
        "EAValue": 0,
        "OPUSValue": 0,
        "BBINValue": 0,
    }


    for (var i = 0; i < data.length; i++) {
        switch(data[i].code) {
            case "main":
                walletMap['mainValue'] = data[i].percent; 
                amountMap['mainValue'] = data[i].amount; 
                total = total + data[i].percent;
                // console.log(total);
                break;
            case "BBIN":
                walletMap['BBINValue'] = data[i].percent;
                amountMap['BBINValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "OPUS":
                walletMap['OPUSValue'] = data[i].percent;
                amountMap['OPUSValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "GPI":
                walletMap['GPIValue']= data[i].percent;
                amountMap['GPIValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "PT":
                walletMap['PTValue'] = data[i].percent;
                amountMap['PTValue']= data[i].amount; 
                total = total + data[i].percent;
                break;
            case "EA":
                walletMap['EAValue'] = data[i].percent;
                amountMap['EAValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "KY":
                walletMap['KYValue'] = data[i].percent;
                amountMap['KYValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "Onebook":
                walletMap['OnebookValue'] = data[i].percent;
                amountMap['OnebookValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            case "AG":
                walletMap['AGValue'] = data[i].percent;
                amountMap['AGValue'] = data[i].amount; 
                total = total + data[i].percent;
                break;
            default:
        }
    }
    
    if (total == 0) {
        $('#chart5').text("There is no balance in each wallet")

    } else {
        var data1 = {
        Â Â series: [{value: walletMap['mainValue'],Â Â className: "mainWallet"}, {value: walletMap['OnebookValue'],Â Â className: "onebookWallet"}, {value: walletMap['PTValue']Â ,Â className: "PTWallet"}, {value: walletMap['AGValue'],Â Â className: "AGWallet"}, {value: walletMap['KYValue'],Â Â className: "KYWallet"}, {value: walletMap['GPIValue'],Â Â className: "GPIWallet"}, {value: walletMap['EAValue'],Â Â className: "EAWallet"}, {value: walletMap['OPUSValue'],Â Â className: "OPUSWallet"}, {value: walletMap['BBINValue'],Â Â className: "BBINWallet"}]
        };

        var option1 = {
        Â Â width: 130,
        Â Â height: 130,
        showLabel: false
        Â Â 
        }

        new Chartist.Pie('#chart5', data1, option1);
        var content = '';
        content += '<div class="col-md-2" style="width: 20%; padding-left:0px"><div><span class="dot mainWallet"></span>Main</div><div><span class="dot onebookWallet"></span>Onebook</div><div><span class="dot PTWallet"></span>PT</div><div><span class="dot AGWallet"></span>AG</div><div><span class="dot KYWallet"></span>KY</div></div><div class="col-md-4" style="width: 30%; padding-left:0px">';
        content += '<div>' + amountMap['mainValue'] + ' (' + walletMap['mainValue']  + '%)' + '</div><div>'  + amountMap['OnebookValue'] + ' (' + walletMap['OnebookValue']  + '%)' + '</div><div>'+ amountMap['PTValue'] + ' (' + walletMap['PTValue']  + '%)' + '</div><div>'+ amountMap['PTValue'] + ' (' + walletMap['PTValue']  + '%)' +'</div><div>' + amountMap['AGValue'] + ' (' + walletMap['AGValue']  + '%)' + '</div></div>';
        content += '<div class="col-md-2" style="padding-left:0px"><div><span class="dot GPIWallet"></span>GPI</div><div><span class="dot EAWallet"></span>EA</div><div><span class="dot OPUSWallet"></span>OPUS</div><div><span class="dot BBINWallet"></span>BBIN</div></div><div class="col-md-4"  style="padding-left:0px">';
        content += '<div>' + amountMap['GPIValue'] + ' (' + walletMap['GPIValue']  + '%)' + '</div><div>'  + amountMap['EAValue'] + ' (' + walletMap['EAValue']  + '%)' + '</div><div>'+ amountMap['OPUSValue'] + ' (' + walletMap['OPUSValue']  + '%)' + '</div><div>'+ amountMap['BBINValue'] + ' (' + walletMap['BBINValue']  + '%)' +'</div></div>';

        $("#walletData").empty();
        $("#walletData").append(content);

    }
}


function submitAdjustment() {

    if (!confirm("Are you sure you want to make a adjustment!")) {
        return;
    }

    var affiliate = false;
    var reason = -1;
    var debitOrCredit = "";
    var amount = 0;
    var notifyPlayer = false;
    var messageSubject = "";
    var messageToPlayer = "";
    var messageNote = "";
    var wageringAmount = 0;
    if($('#affiliate').is(":checked")){
        affiliate = true;
    } 

    if($('input[name="adjust-notify-player"]').is(":checked")){
        notifyPlayer = true;
    } 

    debitOrCredit = $("input[name='debit-credit']:checked").val();
    if (debitOrCredit == 'credit') {
        wageringAmount = $("input[name='wagering_amount']").val();
    }
    reason = $('#adjustment_reason').val();
    amount = $("#adjust_amount").val();
    messageSubject = $("#adjust_message_subject").val();
    messageToPlayer = $("#message_to_player").val();
    messageNote = $("#message_note").val();
    
    // console.log(amount);
    // console.log(notifyPlayer);
    console.log(messageSubject);
    console.log(messageToPlayer);
    console.log(messageNote);
    // console.log(wageringAmount);

    if (reason == -1 || amount <= 0 || (debitOrCredit == 'credit' && wageringAmount <= 0) || (notifyPlayer && (messageSubject.length == 0 ||  messageToPlayer.length == 0)) || messageNote.length == 0) {
        alert("please put the correct information");
        return;
    }

    data = {
        'adjustment_reason': reason,
        'amount': amount,
        'debit_or_credit': debitOrCredit,
        'notify_player': notifyPlayer,
        'affiliate': affiliate,
        'message_subject': messageSubject,
        'message_to_player': messageToPlayer,
        'message_note': messageNote,
    }

    if (debitOrCredit == 'credit') {
        data['wagering_amount'] = wageringAmount;
    }

    postAdjustmentRequest(data);

}


function postAdjustmentRequest(data) {
    var user_id = $('#hidden_user_id').val();
    data['user_id'] = user_id
    $.ajax({
        type:'POST',
        url:"{% url 'user_adjustment' %}",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType   : "json",
        success:function(data) {
            location.reload();
        },
        error: function() {
            $('#adjustment_error').text("Something wrong");
        }
    });
}


function submitTransfer() {

    var transfer_to = $('#transfer_to').val();
    var transfer_from = $('#transfer_from').val();
    if (!confirm("Are you sure you want to make a transfer from " + transfer_to + " wallet to " + transfer_from + " wallet")) {
        return;
    }

    var user_id = $('#hidden_user_id').val();
    
    var transfer_amount = $('#transfer_amount').val();
    var message_note = $('#transfer_message_note').val();
    var messageSubject = $("#transfer_message_subject").val();
    var messageToPlayer = $("#transfer_message_to_player").val();
     var notifyPlayer = false;
    if($('input[name="transfer-notify-player"]').is(":checked")){
        notifyPlayer = true;
    } 
    data = {
        'user_id': user_id,
        'transfer_to': transfer_to,
        'transfer_from': transfer_from,
        'transfer_amount': transfer_amount,
        'message_note': message_note,
        'message_subject': messageSubject,
        'message_to_player': messageToPlayer,
        'notify_player': notifyPlayer
    }
    // console.log(transfer_to, transfer_from, transfer_amount);
    postSubmitTransfer(data);
}


function postSubmitTransfer(data) {
    $.ajax({
        type:'POST',
        url:"{% url 'user_transfer' %}",
        data: JSON.stringify(data),
        contentType: "application/json; charset=utf-8",
        dataType   : "json",
        success:function(data) {
            console.log(data);
            location.reload();
        },
        error: function() {
            $('#adjustment_error').text("Something wrong");
        }
    });
}





// product data

function getProductAmount(user_id) {

    // setTimeout(showPage, 6000);
    
    $.ajax({
        type:'GET',
        url:"{% url 'product_contribution' %}",
        data: {
            'user_id': user_id,
        },
        success:function(data) {
            console.log(data);
            $('.product-loader').css('display', 'none');
            $('#eachProduct').css('display', 'block');
            renderProductChart(data);
        },
        error: function() {
            showWrong();
        }
    });

}

function showWrong() {
    $('#chart6').text("There is something wrong");
    $('#chart6').css('width', '300px');
    $('.product-loader').css('display', 'none');
    $('#eachProduct').css('display', 'block');
}


function renderProductChart(data) {

    var data1 = {
        series: [{value: data['sport_percent'],Â Â className: "sport"}, {value: data['games_percent'],Â Â className: "games"}, {value: data['live_casino_percent']Â ,Â className: "liveCasino"}, {value: data['lottery_percent'],Â Â className: "lottery"}]
        };

        var option1 = {
        Â Â width: 130,
        Â Â height: 130,
        showLabel: false
        }

        new Chartist.Pie('#chart6', data1, option1);
        var content = '';
        content += '<div class="col-md-2" style="width: 20%; padding-left:0px"><div><span class="dot sport"></span>Sport</div><div><span class="dot games"></span>Games</div></div><div class="col-md-2" style="width: 20%; padding-left:0px">';
        content += '<div>' + data['sport_value'] + ' (' + data['sport_percent']  + '%)' + '</div><div>'  + data['games'] + ' (' + data['games_percent']  + '%)' + '</div></div>';
        
        content += '<div class="col-md-3" style="width: 26%; padding-left:0px"><div><span class="dot liveCasino"></span>Live Casino</div><div><span class="dot lottery"></span>Lottery</div></div><div class="col-md-4" style="width: 33%; padding-left:0px">';
        content += '<div>' + data['live_casino'] + ' (' + data['live_casino_percent']  + '%)' + '</div><div>'  + data['lottery'] + ' (' + data['lottery_percent']  + '%)' + '</div></div>';

        $("#productData").empty();
        $("#productData").append(content);
    }



</script>


{% endblock %}
